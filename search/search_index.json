{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Overview","text":""},{"location":"#what-do-we-do","title":"What do we do?","text":"<p>We build Google BigQuery data automation capabilities, using native BigQuery functionality and adjacent Google Cloud products. In order to transform and augment inbound data to support subsequent analytics, automation and AI use-cases, we build and deploy source-specific data decoders for our clients and partners, and license them to 3rd parties.</p>"},{"location":"#what-is-a-decoder","title":"What is a decoder?","text":"<p>A decoder restructures and augments inbound data to optimise the structure and contents for query and analysis. It is essentially an upgrade to a standard inbound data source, removing complexity from downstream operations in order to speed up (and level-up) subsequent data activities.</p> <p>It is installed between standard Google-managed inbound BigQuery data sources and subsequent transformation, augmentation, analysis or automation activities.</p> Decoder Logical Flow <pre><code>flowchart LR\n source_data([\"Source Data\"]) --&gt; inbound_data[\"Inbound&lt;br&gt;Data Transfer\"] --&gt; decoder{{\"Decoder\"}} --&gt; outbound_data[\"Outbound&lt;br&gt;Data Assets\"] --&gt; downstream_activities_gc([\"Downstream&lt;br&gt;Data Activities\"])\n\n style decoder fill:#ffffff,stroke:#333,stroke-width:2px</code></pre> <p>It efficiently and reponsively builds downstream data assets and is optionally configurable upon deployment, with pre-configured installation functions for connection to Looker, Looker Studio, Tableau, Power BI, other business intelligence tools or even cross-cloud storage buckets.</p> <p>Downstream tables can also be connected directly to data transformation-specific tools like Dataform or DBT, to simplify subsequent data modelling activities.</p> <p>By using a metadata-driven approach, it is responsive to newly arriving data in a cost-optimal manner and requires minimal ongoing maintenance or monitoring (although metadata-based monitoring functions are provided).</p>"},{"location":"#why-would-you-need-one","title":"Why would you need one?","text":"<p>Inbound data structures are typically designed for optimal storage and schema stability, not for simplicity of modelling, query or analytics. Specifically, nested data structures pose challenges as the structure of the nested data needs to be known ahead of time in order to extract meaningful data. This also applies to JSON data.</p> <p>Historically this has meant that transforming this data required painfully hand-crafting queries with a verbose, unintuitive and uncommon query syntax, slowing down subsequent data-related activities.</p> <p>Many Google-managed inbound data transfers also do not arrive at a consistent time every day, which can be challenging to control for efficiently and reliably.</p>"},{"location":"#how-does-it-work","title":"How does it work?","text":"<p>Decoders are installed by executing a BigQuery function with installation-specific configuration arguments. Installation involves the following automated stages:</p> <ol> <li>Profile data structure, contents and types</li> <li>Build source-specific decoder functions based on configuration and data profile</li> <li>Build output assets (typically date-partitioned tables)</li> <li>Deploy automation, monitoring and installation functions</li> </ol> Decoder Installation <pre><code>flowchart LR\n profile_data[\"Profile&lt;br&gt;Data\"] --&gt; build_decoder_functions[\"Build&lt;br&gt;Decoder&lt;br&gt;Functions\"] --&gt; build_output_assets[\"Build&lt;br&gt;Output&lt;br&gt;Assets\"] --&gt; deploy_automation_function[\"Deploy&lt;br&gt;Management&lt;br&gt;Functions\"] </code></pre> <p>Once a decoder is installed, the output data assets can then be:</p> <ul> <li>queried directly;</li> <li>connected directly to business intelligence tools;</li> <li>used as an input to simplified transformation models; and </li> <li>extended with SQL to customise subsequent data transformation.</li> </ul> <p>Decoders are built using native (but extended) BigQuery functionality, so do not require external platforms or API calls. Decoders can be deployed on whitelisted datasets, by users with the appropriate permissions to call the specific installation functions.</p> <p>A simple automation function is deployed in the decoder dataset, which checks and compares inbound shard and outbound partition metadata. New date partitions are identified, transformation/augmentation logic is applied to the newly-arrived data and the output data tables are updated incrementally.</p> <p>This is triggered on a regular schedule (as short as every 5 minutes, but typically hourly), and can also be called manually to refesh specific partition subsets of the outbound tables. Since this is built on metadata queries (and does not query the underlying data) it is a simple mechanism to execute data transformations upon arrival of both predictably and unpredictably timed inbound data.</p> <p>Access to installation and automation functions is granted to permitted users on whitelisted datasets.</p>"},{"location":"#where-is-it-installed","title":"Where is it installed?","text":"<p>A decoder is installed in a configurable dataset (within the same region as the inbound data), but typically the same dataset as the inbound data. </p> <p>Decoders can deployed programmatically across hundreds of data sources in just a few lines of code. No configuration is required, but decoders can be configured in granular ways depending on the use-case and data.</p>"},{"location":"#what-decoders-are-available","title":"What Decoders are available?","text":"<p>The Google Analytics 4 Decoder is in pre-launch with selected agencies and enterprises. Apply for access here.</p> <p>Additional decoders are also in development and are currently being used on a variety of internal and client projects.</p>"},{"location":"privacy/","title":"Privacy Notice","text":"<p>This is the privacy notice of Decode Data Ltd, a company registered in England and Wales with company number 15503524 and registered office address at 124-128 City Road, London EC1V 2NX.</p>"},{"location":"privacy/#introduction","title":"Introduction","text":"<p>This notice describes how we collect, store, transfer and use personal data. It tells you about your privacy rights and how the law protects you.</p> <p>In the context of the law and this notice, \u00d4personal data\u00d5 is information that clearly identifies you as an individual or which could be used to identify you if combined with other information. Acting in any way on personal data is referred to as \"processing\".</p> <p>This notice applies to personal data collected through our website and through social media platforms.</p> <p>Except as set out below, we do not share, or sell, or disclose to a third party, any information collected through our website.</p>"},{"location":"privacy/#personal-data-we-process","title":"Personal data we process","text":"<p>1. How we obtain personal data</p> <p>The information we process about you includes information:</p> <ul> <li>you have directly provided to us</li> <li>that we gather from third party databases and service providers</li> <li>as a result of monitoring how you use our website or our services</li> </ul> <p>2. Types of personal data we collect directly</p> <p>When you use our website, create an account with us, buy from us, or use our services, we may ask you to provide personal data. This can be categorised into the following groups:</p> <ul> <li>personal identifiers, such as your first and last names, your title and your date of birth</li> <li>contact information, such as your email address, your telephone number and your postal addresses for billing, delivery and communication</li> <li>account information, including your username and password</li> <li>payment information, such as a debit or credit card number and expiry date and bank account details</li> <li>records of communication between us including messages sent through our website and social media channels, email messages and telephone conversations</li> <li>marketing preferences that tell us what types of marketing you would like to receive</li> </ul> <p>3. Types of personal data we collect from third parties</p> <p>We may confirm some of the information you provide to us directly using data from other sources. We also add to the information we hold about you, sometimes to remove the need for you to provide it to us and sometimes in order to be able to assess the quality of the services you offer.</p> <p>The additional information we collect can be categorised as follows:</p> <ul> <li>information that confirms your identity</li> <li>business information, including your business trading name and address, your company number (if incorporated), and your VAT number (if registered)</li> <li>information that confirms your contact information</li> <li>reviews and feedback about your business on other websites through which you sell your services</li> <li>unsolicited complaints by other users</li> </ul> <p>4. Types of personal data we collect from your use of our services</p> <p>When you use our website and our services, we may process:</p> <ul> <li>your username and password and other information used to access our website and our services</li> <li>information you contribute to our community, including reviews</li> <li>your replies to polls and surveys</li> <li>technical information about the hardware and the software you use to access our website and use our services, including your Internet Protocol (IP) address, your browser type and version and your device\u00d5s operating system</li> <li>usage information, including the frequency you use our services, the pages of our website that you visit, whether you receive messages from us and whether you reply to those messages</li> <li>transaction information that includes the details of the products services you have bought from us and payments made to us for those services</li> <li>your preferences to receive marketing from us; how you wish to communicate with us; and responses and actions in relation to your use of our services.</li> </ul> <p>5. Our use of aggregated information</p> <p>We may aggregate anonymous information such as statistical or demographic data for any purpose. Anonymous information is that which does not identify you as an individual. Aggregated information may be derived from your personal data but is not considered as such in law because it does not reveal your identity.</p> <p>For example, we may aggregate usage information to assess whether a feature of our website is useful.</p> <p>However, if we combine or connect aggregated information with your personal data so that it can identify you in any way, we treat the combined information as personal data, and it will be used in accordance with this privacy notice.</p> <p>6. Special personal data</p> <p>Special personal data is data about your race or ethnicity, religious or philosophical beliefs, sex life, sexual orientation, political opinions, trade union membership, information about your health and genetic and biometric data.</p> <p>We do not collect any special personal data about you.</p> <p>7. If you do not provide personal data we need</p> <p>Where we need to collect personal data by law, or under the terms of a contract we have with you, and you fail to provide that data when requested, we may not be able to perform that contract.</p> <p>In that case, we may have to stop providing a service to you. If so, we will notify you of this at the time.</p>"},{"location":"privacy/#the-basis-on-which-we-process-information-about-you","title":"The basis on which we process information about you","text":"<p>The law requires us to determine under which of six defined bases we process different categories of your personal data, and to notify you of the basis for each category.</p> <p>If a basis on which we process your personal data is no longer relevant then we shall immediately stop processing your data.</p> <p>If the basis changes then if required by law we shall notify you of the change and of any new basis under which we have determined that we can continue to process your information.</p> <p>8. Information we process because we have a contractual obligation with you</p> <p>When you create an account on our website, buy a product or service from us, or otherwise agree to our terms and conditions, a contract is formed between you and us.</p> <p>In order to carry out our obligations under that contract we must process the information you give us. Some of this information may be personal data.</p> <p>We may use it in order to:</p> <ul> <li>verify your identity for security purposes when you use our services</li> <li>sell products to you</li> <li>provide you with our services</li> <li>provide you with suggestions and advice on products, services and how to obtain the most from using our website</li> </ul> <p>We process this information on the basis there is a contract between us, or that you have requested we use the information before we enter into a legal contract.</p> <p>We shall continue to process this information until the contract between us ends or is terminated by either party under the terms of the contract.</p> <p>9. Information we process with your consent</p> <p>Through certain actions when otherwise there is no contractual relationship between us, such as when you browse our website or ask us to provide you more information about our business, including our products and services, you provide your consent to us to process information that may be personal data.</p> <p>Wherever possible, we aim to obtain your explicit consent to process this information, for example, we ask you to agree to our use of non-essential cookies when you access our website.</p> <p>If you have given us explicit permission to do so, we may from time to time pass your name and contact information to selected associates whom we consider may provide services or products you would find useful.</p> <p>We continue to process your information on this basis until you withdraw your consent or it can be reasonably assumed that your consent no longer exists.</p> <p>You may withdraw your consent at any time by contacting us, using the channels described on our website. However, if you do so, you may not be able to use our website or our services further.</p> <p>We aim to obtain and keep your consent to process your information. However, while we take your consent into account in decisions about whether or not to process your personal data, the withdrawal of your consent does not necessarily prevent us from continuing to process it. The law may allow us to continue to process your personal data, provided that there is another basis on which we may do so. For example, we may have a legal obligation to do so.</p> <p>10. Information we process for the purposes of legitimate interests</p> <p>We may process information on the basis there is a legitimate interest, either to you or to us, of doing so.</p> <p>Where we process your information on this basis, we do after having given careful consideration to:</p> <ul> <li>whether the same objective could be achieved through other means</li> <li>whether processing (or not processing) might cause you harm</li> <li>whether you would expect us to process your data, and whether you would, in the round, consider it reasonable to do so For example, we may process your data on this basis for the purposes of:</li> <li>improving our services</li> <li>record-keeping for the proper and necessary administration of our business</li> <li>responding to unsolicited communication from you to which we believe you would expect a response</li> <li>preventing fraudulent use of our services</li> <li>exercising our legal rights, including to detect and prevent fraud and to protect our intellectual property</li> <li>insuring against or obtaining professional advice that is required to manage business risk</li> <li>protecting your interests where we believe we have a duty to do so</li> </ul> <p>11. Information we process because we have a legal obligation</p> <p>Sometimes, we must process your information in order to comply with a statutory obligation.</p> <p>For example, we may be required to give information to legal authorities if they so request or if they have the proper authorisation such as a search warrant or court order.</p> <p>This may include your personal data.</p>"},{"location":"privacy/#how-and-when-we-process-your-personal-data","title":"How and when we process your personal data","text":"<p>12. Your personal data is not shared</p> <p>We do not share or disclose to a third party, any information collected through our website.</p> <p>13. Payment information</p> <p>Payment information is never taken by us or transferred to us either through our website or otherwise. Our employees and contractors never have access to it.</p> <p>At the point of payment, you are transferred to a secure page on the website of Stripe or some other reputable payment service provider. That page may be branded to look like a page on our website, but it is not controlled by us.</p> <p>14. Job application and employment</p> <p>If you send us information in connection with a job application, we may keep it for up to three years in case we decide to contact you at a later date.</p> <p>If we employ you, we collect information about you and your work from time to time throughout the period of your employment. This information will be used only for purposes directly relevant to your employment. After your employment has ended, we will keep your file for six years before destroying or deleting it.</p> <p>15. Information obtained from third parties</p> <p>Although we do not disclose your personal data to any third party (except as set out in this notice), we sometimes receive data that is indirectly made up from your personal data from third parties whose services we use.</p> <p>No such information is personally identifiable to you.</p> <p>16. Third party advertising on our website</p> <p>Third parties may advertise on our website. In doing so, those parties, their agents or other companies working for them may use technology that automatically collects information about you when their advertisement is displayed on our website.</p> <p>They may also use other technology such as cookies or JavaScript to personalise the content of, and to measure the performance of their adverts.</p> <p>We do not have control over these technologies or the data that these parties obtain. Accordingly, this privacy notice does not cover the information practices of these third parties.</p> <p>17. Credit reference</p> <p>To assist in combating fraud, we may share information with credit reference agencies, so far as it relates to clients or customers who instruct their credit card issuer to cancel payment to us without having first provided an acceptable reason to us and given us the opportunity to refund their money.</p> <p>18. Service providers and business partners</p> <p>We may share your personal data with businesses that provide services to us, or with business partners.</p> <p>As examples:</p> <ul> <li>we may pass your payment information to our payment service provider to take payments from you</li> <li>we may use fraud prevention agencies and credit reference agencies to verify your identity and we may pass your information to those agencies if we strongly suspect fraud on our website</li> <li>with your permission, we may pass your contact information to advertising agencies to use to promote our services to you</li> </ul> <p>19. Referral partners</p> <p>This is information given to us by you in your capacity as an affiliate of us or as a referral partner.</p> <p>It allows us to recognise visitors that you have referred to us, and to credit to you commission due for such referrals. It also includes information that allows us to transfer commission to you.</p> <p>The information is not used for any other purpose.</p> <p>We undertake to preserve the confidentiality of the information and of the terms of our relationship. </p> <p>We expect any affiliate or partner to agree to reciprocate this policy.</p>"},{"location":"privacy/#use-of-information-we-collect-through-automated-systems","title":"Use of information we collect through automated systems","text":"<p>20. Cookies</p> <p>Cookies are small text files that are placed on your computer's hard drive by your web browser when you visit a website that uses them. They allow information gathered on one web page to be stored until it is needed for use at a later date.</p> <p>They are commonly used to provide you with a personalised experience while you browse a website, for example, allowing your preferences to be remembered.</p> <p>They can also provide core functionality such as security, network management, and accessibility; record how you interact with the website so that the owner can understand how to improve the experience of other visitors; and serve you advertisements that are relevant to your browsing history.</p> <p>Some cookies may last for a defined period of time, such as one visit (known as a session), one day or until you close your browser. Others last indefinitely until you delete them.</p> <p>Your web browser should allow you to delete any cookie you choose. It should also allow you to prevent or limit their use. Your web browser may support a plug-in or add-on that helps you manage which cookies you wish to allow to operate. </p> <p>The law requires you to give explicit consent for use of any cookies that are not strictly necessary for the operation of a website.</p> <p>When you first visit our website, we ask you whether you wish us to use cookies. If you choose not to accept them, we shall not use them for your visit except to record that you have not consented to their use for any other purpose.</p> <p>If you choose not to use cookies or you prevent their use through your browser settings, you may not be able to use all the functionality of our website.</p> <p>We may use cookies in the following ways:</p> <ul> <li>to track how you use our website</li> <li>to record whether you have seen specific messages we display on our website</li> <li>to keep you signed in to our website</li> <li>to record your answers to surveys and questionnaires on our site while you complete them</li> <li>to record the conversation thread during a live chat with our support team</li> </ul> <p>21. Personal identifiers from your browsing activity</p> <p>Requests by your web browser to our servers for web pages and other content on our website are recorded.</p> <p>We record information such as your geographical location, your Internet service provider and your IP address. We also record information about the software you are using to browse our website, such as the type of computer or device and the screen resolution.</p> <p>We use this information in aggregate to assess the popularity of the webpages on our website and how we perform in providing content to you.</p> <p>If combined with other information we know about you from previous visits, the data possibly could be used to identify you personally, even if you are not signed in to our website.        </p> <p>22. Re-marketing</p> <p>Re-marketing involves placing a \"tracking technology\" such as a cookie, a \"web beacon\" (also known as an \"action tag\" or a \"single-pixel GIF\") to track which pages you visit and to serve you relevant adverts for our services when you visit some other website.</p> <p>The benefit of re-marketing technology is that we can provide you with more useful and relevant adverts, and not show you ones repeatedly that you may have already seen.</p> <p>We may use a third-party advertising service to provide us with re-marketing services from time to time. If you have consented to our use of such tracking technologies, you may see advertisements for our products and services on other websites.</p> <p>We do not provide your personal data to advertisers or to third-party re-marketing service providers. However, if you are already a member of a website whose affiliated business provides such services, that affiliated business may learn of your preferences in relation to your use of our website.</p>"},{"location":"privacy/#other-matters","title":"Other matters","text":"<p>23. Your rights</p> <p>The law requires us to tell you about your rights and our obligations to you in regard to the processing and control of your personal data. We do this now, by requesting that you read the information provided at http://www.knowyourprivacyrights.org.</p> <p>24. Use of our services by children</p> <p>We do not sell products or provide services for purchase by children, nor do we market to children.</p> <p>If you are under 18, you may use our website only with consent from a parent or guardian.</p> <p>We collect data about all users of and visitors to these areas regardless of age, and we anticipate that some of those users and visitors will be children.</p> <p>25. Data may be processed outside the UK</p> <p>Our websites are hosted by a third party and may be hosted outside the UK.</p> <p>We also use outsourced services in countries outside the UK from time to time in other aspects of our business.</p> <p>Accordingly, data obtained within the UK or any other country will be processed outside the UK.</p> <p>We use the following safeguards with respect to data transferred outside the UK:</p> <ul> <li>the processor is within the same corporate group as our business or organisation and abides by the same binding corporate rules regarding data processing.</li> </ul> <p>26. Control over your own information</p> <p>It is important that the personal data we hold about you is accurate and up to date. Please inform us if your personal data changes.</p> <p>At any time, you may contact us to request that we provide you with the personal data we hold about you.</p> <p>At any time you may review or update personally identifiable information that we hold about you, by signing in to your account on our website.</p> <p>To obtain a copy of any information that is not provided on our website you should contact us to make that request.</p> <p>When we receive any request to access, edit or delete personal data we first take reasonable steps to verify your identity before granting you access or otherwise taking any action. This is important to safeguard your information.</p> <p>Please be aware that we are not obliged by law to provide you with all personal data we hold about you, and that if we do provide you with information, the law allows us to charge for such provision if doing so incurs costs for us. After receiving your request, we will tell you when we expect to provide you with the information, and whether we require any fee for providing it to you.</p> <p>If you wish us to remove personally identifiable information from our website, you should contact us to make your request. This may limit the service we can provide to you.</p> <p>We remind you that we are not obliged by law to delete your personal data or to stop processing it simply because you do not consent to us doing so.  While having your consent is an important consideration as to whether to process it, if there is another legitimate basis on which we may process it, we may do so on that basis.</p> <p>27. Communicating with us</p> <p>When you contact us, whether by telephone, through our website or by email, we collect the data you have given to us in order to reply with the information you need.</p> <p>We record your request and our reply in order to increase the efficiency of our business.</p> <p>We may keep personally identifiable information associated with your message, such as your name and email address so as to be able to track our communications with you to provide a high quality service.</p> <p>28. Complaining</p> <p>If you are not happy with our privacy policy, or if you have any complaint, then you should contact us, using the details provided on our website.</p> <p>When we receive a complaint, we record the information you have given to us on the basis of consent. We use that information to resolve your complaint.</p> <p>If we think your complaint is vexatious or without any basis, we shall not correspond with you about it.</p> <p>If your complaint reasonably requires us to notify some other person, we may decide to give to that other person some of the information contained in your complaint. We do this as infrequently as possible, but it is a matter for our sole discretion whether we do give information, and if we do, what that information is.</p> <p>We may also compile statistics showing information obtained from this source to assess the level of service we provide, but not in a way that could identify you or any other person.</p> <p>If a dispute is not settled then we hope you will agree to attempt to resolve it by engaging in good faith with us in a process of mediation or arbitration.</p> <p>If you are in any way dissatisfied about how we process your personal data, you have a right to lodge a complaint with the Information Commissioner's Office (ICO). This can be done at https://ico.org.uk/make-a-complaint/. We would, however, appreciate the opportunity to talk to you about your concern before you approach the ICO.</p> <p>29. Retention period</p> <p>Except as otherwise mentioned in this privacy notice, we keep your personal data only for as long as required by us:</p> <ul> <li>to provide you with the services you have requested</li> <li>to comply with other law, including for the period demanded by our tax authorities</li> <li>to support a claim or defence in court</li> </ul> <p>30. Compliance with the law</p> <p>Our privacy policy complies with the law in the United Kingdom, specifically with the Data Protection Act 2018 (the \"Act\") accordingly incorporating the EU General Data Protection Regulation (\"GDPR\") and the Privacy and Electronic Communications Regulations (\"PECR\").</p> <p>31. Review of this privacy policy</p> <p>We shall update this privacy notice from time to time as necessary.</p>"},{"location":"terms/","title":"Terms and Conditions","text":"<p>These terms and conditions are the contract between you and Decode Data Ltd (\"us\", \"we\", etc). By visiting or using Our Website, or signing up for our Services, you agree to be bound by them.</p> <p>We are Decode Data Ltd, a company registered in England and Wales with company number 15503524 and registered office address at 124-128 City Road, London EC1V 2NX.</p> <p>You are anyone who uses Our Website or buys our Services from us.</p> <p>Please read this agreement carefully and save it. If you do not agree with it, you should leave Our Website and stop using our Services immediately.</p> <p>These are the agreed terms:</p>"},{"location":"terms/#1-definitions","title":"1.   Definitions","text":"<p>\"Content\"   means the textual, visual or aural content that is encountered as part of your experience on Our Website. It may include, among other things: text, images, sounds, videos and animations. </p> <p>\"Intellectual Property\" means intellectual property owned by us, of every sort, whether or not registered or registrable in any country, including intellectual property of all kinds coming into existence after today; and including, among others, patents, trademarks, unregistered marks, designs, copyrights, software, domain names, discoveries, creations and inventions, together with all rights which are derived from those rights.</p> <p>\"Our Website\"   means any website or service designed for electronic access by mobile or fixed devices which is owned or operated by us. It includes all web pages controlled by us. </p> <p>\"Post\"  means place on or into Our Website any Content or material of any sort by any means.</p> <p>\"Services\"  means all of the services available from Our Website or otherwise provided by us, whether free or charged.</p>"},{"location":"terms/#2-interpretation","title":"2.   Interpretation","text":"<p>In this agreement unless the context otherwise requires:</p> <p>2.1.    a reference to a person includes a human individual, a corporate entity and any organisation which is managed or controlled as a unit.</p> <p>2.2.    a reference to a person includes reference to that person's successors, legal representatives, permitted assigns and any person to whom rights and obligations are transferred or passed as a result of a merger, division, reconstruction or other re-organisation involving that person.</p> <p>2.3.    in the context of permission, \"may not\" in connection with an action of yours, means \"must not\".</p> <p>2.4.    the headings to the paragraphs of this agreement are inserted for convenience only and do not affect the interpretation.</p> <p>2.5.    any agreement by either party not to do or omit to do something includes an obligation not to allow some other person to do or omit to do that same thing;</p> <p>2.6.    except where stated otherwise, any obligation of any person arising from this agreement may be performed by any other person;</p> <p>2.7.    a reference to an act or regulation includes new law of substantially the same intent as the act or regulation referred to.</p> <p>2.8.    these terms and conditions apply to all supplies of Services by us. They prevail over any terms proposed by you.</p> <p>2.9.    this agreement is made only in the English language. If there is any conflict in meaning between the English language version of this agreement and any version or translation of this agreement in any other language, the English language version shall prevail.</p>"},{"location":"terms/#3-eligibility","title":"3.   Eligibility","text":"<p>3.1 The Services are not intended for use by consumers and the applicability of consumer protection legislation is therefore excluded. You represent and warrant that any information you submit is true and accurate and that you are 18 years of age or older and fully able and competent to enter into and abide by these terms and conditions. </p> <p>3.2 By signing up on behalf of a business, partnership, company or other organisation, you represent and warrant that you have the authority to bind that business, partnership, company or other organisation.</p>"},{"location":"terms/#4-basis-of-contract","title":"4.   Basis of Contract","text":"<p>4.1.    In entering into this contract, you have not relied on any representation or information from any source except the definition and explanation of the Services given on Our Website.</p> <p>4.2.    Subject to these terms and conditions, we agree to provide to you some or all of the Services described on Our Website at the prices displayed on Our Website.</p> <p>4.3.    You acknowledge that you understand exactly what is included in the Services and you are satisfied that the Services are suitable and satisfactory for your requirements.</p> <p>4.4.    So far as we allow use of our Intellectual Property, we grant a licence to you, limited to the terms set out in this agreement.</p> <p>4.5.    Our contract with you and licence to you last for one year from the date of payment or one month from the date of payment, depending on whether you have chosen an annual or a monthly payment plan. Any continuation by us or by you after the date of expiry of that licence (the \"Renewal Date\") is a new contract under the terms Posted on Our Website at that time. </p> <p>4.6.    The contract between us comes into existence when we receive payment from you for a Service.</p> <p>4.7.    We may change this agreement or the way we provide the Services, at any time. If we do so:</p> <p>4.7.1   the change will take effect when we Post it on Our Website.</p> <p>4.7.2   we will give you notice of the change by email. You will be deemed to have accepted the change unless you tell us otherwise within 7 days. If you do not accept the change, we may, at our discretion, either:</p> <p>4.7.2.1 cancel your subscription with immediate effect and provide a refund for the portion of the Services that have been paid for but not yet used; or</p> <p>4.7.2.2 continue to provide the Services until your next Renewal Date, in which case our relationship with you will be governed by the most recent version of these terms and conditions which you have accepted.</p> <p>4.7.3   if you make any payment for Services in the future, you will do so under the terms Posted on Our Website at that time.</p>"},{"location":"terms/#5-your-account-and-personal-information","title":"5.   Your account and personal information","text":"<p>5.1.    When you visit Our Website, you accept responsibility for any action done by any person using your name, account or password. You should take all necessary steps to ensure that the password is kept confidential and secure and should inform us immediately if you have any reason to believe that your password has become known to anyone else, or if the password is being, or is likely to be, used in an unauthorised manner.</p> <p>5.2.    You agree that you have provided accurate, up to date, and complete information about yourself. We are not responsible for any error made as a result of such information being inaccurate.</p> <p>5.3.    You agree to notify us of any changes in your information immediately it occurs. If you do not do so, we may terminate your account.</p>"},{"location":"terms/#6-the-price","title":"6.   The price","text":"<p>6.1.    The price payable for the Services will depend on the service plan you have chosen. Our service plans and prices are clearly set out on Our Website. </p> <p>6.2.    You may change the website properties covered by this agreement at any time using the channels described on Our Website. We will update the Services to comply with your request within one week. If you wish to increase the number of website properties for which the Services are provided beyond the maximum number permitted by your current service plan, you must upgrade your service plan. If you upgrade your service plan, the fee payable under paragraph 6.1 will be updated from your next Renewal Date. If you have chosen an annual payment plan and upgrade to a more expensive service plan, you may be charged a supplementary fee. This fee will be calculated pro rata, based on the number of complete months remaining until your next Renewal Date. If you have chosen an annual payment plan, it will not be possible to downgrade to a cheaper service plan until your next Renewal Date.</p> <p>6.3.    Prices are exclusive of any applicable value added tax or other sales tax.</p>"},{"location":"terms/#7-renewal-payments","title":"7.   Renewal payments","text":"<p>7.1.    Your licence to use the Services will renew automatically every year or every month, depending on whether you have chosen an annual or a monthly payment plan, unless your subscription is cancelled by you or by us.</p> <p>7.2.    At any time before the expiry of your subscription, you may use Our Website to change your payment plan or cancel your subscription. Any changes or cancellations will take effect from your next Renewal Date.</p>"},{"location":"terms/#8-privacy-and-cookies-policy","title":"8.   Privacy and cookies policy","text":"<p>8.1.    Our privacy and cookies policy complies fully with the Data Protection Act 2018 and can be found on Our Website.</p> <p>8.2.    Please notify us of any security breach or unauthorised use of your account.</p>"},{"location":"terms/#9-security-of-our-website","title":"9.   Security of Our Website","text":"<p>You now agree that you will not:</p> <p>9.1.    modify, copy, or cause damage or unintended effect to any portion of Our Website, or the software used to provide the Services.</p> <p>9.2.    access, monitor, or copy any Content or information on Our Website using any robot, spider, scraper, or other automated means or any manual process for any purpose without our express written permission; </p> <p>9.3 take any action that imposes, or may impose, in our opinion, an unreasonable or disproportionately large load on our infrastructure;</p> <p>9.4 \"frame\", \"mirror\", sell, resell, rent or lease any portion of the Services or otherwise incorporate any part of the Services into any other website without prior written authorisation;</p> <p>9.5 link to Our Website in any way that would cause the appearance or presentation of Our Website to be different from what would be seen by a user who accessed Our Website by typing the URL into a standard browser.</p> <p>9.6 Input any virus, malware, or any other harmful code into the Services;</p> <p>9.7 download any part of Our Website, without our express written consent;</p> <p>9.8 collect or use any information obtained from or about Our Website, the Content or the Services except as intended by this agreement;</p> <p>9.9 aggregate, copy or duplicate in any manner any of the Content or information available from Our Website, other than as permitted by this agreement or as is reasonably necessary for your use of the Services;</p> <p>9.10    share with a third party any login credentials to Our Website or the Services;</p> <p>9.11    Despite the above terms, we now grant a licence to you to:</p> <p>9.11.1  create a hyperlink to Our Website for the purpose of promoting an interest common to both of us. You can do this without specific permission. This licence is conditional upon your not portraying us or the Services in a false, misleading, derogatory, or otherwise offensive manner. You may not use any logo or other proprietary graphic or trademark of ours as part of the link without our express written consent.</p> <p>9.11.2  you may copy the text of any page of Our Website for your internal use in connection with the purpose of Our Website or a Service we provide.</p>"},{"location":"terms/#10-intellectual-property","title":"10.  Intellectual Property","text":"<p>You agree that at all times you will:</p> <p>10.1.   not cause or permit anything which may damage or endanger our title to the Intellectual Property.</p> <p>10.2.   notify us of any suspected infringement of the Intellectual Property;</p> <p>10.3.   indemnify us for any loss or expense arising from your misuse of the Intellectual Property;</p> <p>10.4.   on the expiry or termination of this agreement immediately stop using the Intellectual Property except as expressly authorised by us in writing;</p> <p>10.5.   not use any name or mark similar to or capable of being confused with any name or mark of ours;</p> <p>10.6.   You will not:</p> <p>10.6.1  access, attempt to access, copy, modify, create a derivative work of, reverse engineer, decompile or otherwise attempt to extract the source code of the software underlying the Service or any part thereof, unless expressly permitted do so by us. </p> <p>10.6.2  use the Services or the Intellectual Property in any way not anticipated by this agreement;</p> <p>10.6.3  access or use the Services and the Intellectual Property in order to build a similar or competitive product.</p> <p>10.6.4  give access to the Services to any other person than you, the licensee in this agreement;</p> <p>10.6.5  in any way provide any information about the Intellectual Property to any other person</p> <p>10.7.   not use the Intellectual Property in any way that is contrary to the interests of Decode Data Ltd.</p>"},{"location":"terms/#11-third-party-websites-and-content","title":"11.  Third-party websites and Content","text":"<p>11.1    Our Website or the Services may contain links to web pages and Content of third parties as a service to those interested in this information. We do not monitor, endorse, or adopt, or have any control over any third-party web pages or Content. We undertake no responsibility to update or review any such web pages or third-party content and can make no guarantee as to their accuracy or completeness. </p>"},{"location":"terms/#12-termination","title":"12.  Termination","text":"<p>This agreement may be terminated:</p> <p>12.1.   by you, as described in paragraph 7.2.</p> <p>12.2.   if you fail to agree to a change in these Terms and Conditions, as described in paragraph 4.7.</p> <p>12.3.   when we terminate it, without notice, on account of your failure to comply with these terms.</p> <p>12.4.   Immediately by either party if a trustee, receiver, administrative receiver, or similar officer is appointed in respect of all or any part of the business or assets of the other party, or if a petition is presented or a meeting is convened for the purpose of considering a resolution or other steps are taken for the winding up of the other party, or for the making of an administration or bankruptcy order (otherwise than for the purpose of an amalgamation or reconstruction).</p> <p>12.5.   Any termination of this agreement by this paragraph shall be without prejudice to any other rights or remedies to which a party may be entitled.</p> <p>12.6.   On termination, your rights to use the Services will cease:</p> <p>12.6.1  on your next Renewal Date if termination occurs under paragraph 12.1;</p> <p>12.6.2  as described in paragraph 4.7 if termination occurs under paragraph 12.2;</p> <p>12.6.3  immediately if termination occurs under paragraphs 12.3 or 12.4.</p> <p>12.7.   No refund shall be payable if this agreement is terminated under paragraphs 12.3 or 12.4.</p>"},{"location":"terms/#13-interruption-to-services","title":"13.  Interruption to Services","text":"<p>13.1.   If it is necessary for us to interrupt the Services, we will give you reasonable notice where this is possible and when we judge the down time is such as to justify telling you.</p> <p>13.2.   You acknowledge that the Services may also be interrupted for many reasons beyond our control.</p> <p>13.3.   You agree that we are not liable to you for any loss, foreseeable or not, arising from any interruption to the Services.</p>"},{"location":"terms/#14-disclaimers-and-limitation-of-liability","title":"14.  Disclaimers and limitation of liability","text":"<p>14.1.   The law differs from one country to another. This paragraph applies so far as the applicable law allows.</p> <p>14.2.   All implied conditions, warranties and terms are excluded from this agreement. If in any jurisdiction an implied condition, warranty or term cannot be excluded, then this sub-paragraph shall be deemed to be reduced in effect, only to the extent necessary to release that specific condition, warranty or term.</p> <p>14.3.   Our Website and the Services are provided \"as is\". We make no representation or warranty that the Services will be:</p> <p>14.3.1  useful to you;</p> <p>14.3.2  of satisfactory quality;</p> <p>14.3.3  fit for a particular purpose;</p> <p>14.3.4  available or accessible, without interruption, or without error;</p> <p>14.4.   We disclaim any obligation or liability to you arising directly or indirectly from information you take from Our Website.</p> <p>14.5.   We shall not be liable to you for any loss or expense arising out of or in connection with your use of Our Website or the Services, which is indirect or consequential loss, or economic loss or other loss of turnover, profits, business or goodwill. This applies whether in an action of contract, negligence or otherwise, even if such loss was reasonably foreseeable or we knew you might incur it.</p> <p>14.6.   We make no representation or warranty and accept no responsibility in law for:</p> <p>14.6.1  accuracy of any Content or the impression or effect it gives;</p> <p>14.6.2  delivery of Content, material or any message;</p> <p>14.6.3  privacy of any transmission;</p> <p>14.7.   We will do all we can to maintain access to Our Website and the Services, but it may be necessary for us to suspend all or part of the Services for repairs, maintenance or other good reasons. We may do so without telling you first.</p> <p>14.8.   You agree that in any circumstances when we may become liable to you, the limit of our liability is the amount you have paid us in the immediately preceding 12-month period for the Services concerned.</p> <p>14.9.   This paragraph (and any other paragraph which excludes or restricts our liability or provides an indemnity to us) applies to our directors, officers, employees, subcontractors, agents and affiliated companies, as well as to us. Any of them may enforce this provision under the Contracts (Rights of Third Parties) Act 1999.</p> <p>14.10.  If you become aware of any breach of any term of this agreement by any person, please notify us by email. </p> <p>14.11.  Nothing in this agreement excludes liability for a party's fraud.</p>"},{"location":"terms/#15-you-indemnify-us","title":"15.  You indemnify us","text":"<p>You agree to indemnify us against all costs, claims and expense arising directly or indirectly from:</p> <p>15.1.   your failure to comply with the law of any country;</p> <p>15.2.   your breach of this agreement;</p> <p>15.3.   any act, neglect or default by any agent, employee, licensee or customer of yours;</p> <p>15.4.   a contractual claim arising from your use of the Services</p> <p>15.5.   a breach of the intellectual property rights of any person; For the purpose of this paragraph you agree that the cost of our management and technical time is properly recoverable and can reasonably be valued at \u00a3100.00 per hour without further proof.</p>"},{"location":"terms/#16-dispute-resolution","title":"16.  Dispute resolution","text":"<p>The following terms apply in the event of a dispute between the parties:</p> <p>16.1.   If you are not happy with the Services or have any complaint then you should tell us using the channels described on Our Website.</p> <p>16.2.   We will make our reasonable best effort to resolve your complaint or to settle any dispute.</p> <p>16.3.   If a dispute cannot be settled as set out above, you agree to attempt to resolve it by engaging in good faith with us in a process of mediation or arbitration.</p>"},{"location":"terms/#17-miscellaneous-matters","title":"17.  Miscellaneous matters","text":"<p>17.1.   You undertake to provide to us your current land address and e-mail address as often as they are changed together with all information that we may require to enable us to fulfil our obligations under this contract.</p> <p>17.2.   If any term or provision of this agreement is at any time held by any jurisdiction to be void, invalid or unenforceable, then it shall be treated as changed or reduced, only to the extent minimally necessary to bring it within the laws of that jurisdiction and to prevent it from being void and it shall be binding in that changed or reduced form. Subject to that, each provision shall be interpreted as severable and shall not in any way affect any other of these terms.</p> <p>17.3.   The rights and obligations of the parties set out in this agreement shall pass to any permitted successor in title.</p> <p>17.4.   If you are in breach of any term of this agreement, we may:</p> <p>17.4.1  terminate your account and refuse access to Our Website and our Services;</p> <p>17.4.2  issue a claim in any court in England and Wales</p> <p>17.5.   Any obligation in this agreement intended to continue to have effect after termination or completion shall so continue.</p> <p>17.6.   No failure or delay by any party to exercise any right, power or remedy will operate as a waiver of it nor indicate any intention to reduce that or any other right in the future.</p> <p>17.7.   Any communication to be served on either of the parties by the other shall be delivered by hand or sent by first class post or recorded delivery or by e-mail. It shall be deemed to have been delivered:</p> <ul> <li>if delivered by hand: on the day of delivery;</li> <li>if sent by post to the correct address: within 72 hours of posting;</li> <li>if sent by e-mail to the address from which the receiving party has last sent e-mail: within 24 hours if no notice of non-receipt has been received by the sender. </li> </ul> <p>17.8.   This agreement does not give any right to any third party under the Contracts (Rights of Third Parties) Act 1999 or otherwise, except that any provision in this agreement which excludes or restricts the liability of our directors, officers, employees, subcontractors, agents and affiliated companies, may be enforced under that Act.</p> <p>17.9.   Neither party shall be liable for any failure or delay in performance of this agreement which is caused by circumstances beyond its reasonable control, including any labour dispute between a party and its employees.</p> <p>17.10.  In the event of any conflict between any term of this agreement and the provisions of the articles of a limited company or any comparable document intended to regulate any other corporate or collective body, then the terms of this agreement shall prevail.</p> <p>17.11.  The validity, construction and performance of this agreement shall be governed by the laws of England and Wales and you agree that any dispute arising from it shall be litigated only in that country.</p>"},{"location":"bigquery/conventions/","title":"Conventions","text":""},{"location":"bigquery/conventions/#naming-conventions","title":"Naming Conventions","text":"Term  Data Type Description <code>project_id</code> <code>STRING</code> The globally unique identifier for each project <code>dataset_name</code> <code>STRING</code> The name for each dataset, unique in each project <code>dataset_id</code> <code>STRING</code> The globally unique identifier for each dataset, composed as <code>project_id.dataset_name</code> <code>resource_name</code> <code>STRING</code> The single name for each resource (<code>TABLE</code>, <code>VIEW</code>, <code>FUNCTION</code>, <code>TABLE FUNCTION</code> or <code>PROCEDURE</code>) <code>resource_id</code> <code>STRING</code> The globally unique identifier for an individual <code>TABLE</code>, <code>VIEW</code>, <code>FUNCTION</code>, <code>TABLE FUNCTION</code> or <code>PROCEDURE</code>, composed as <code>project_id.dataset_name.resource_name</code> <code>date_id</code> <code>STRING</code> A <code>STRING</code> representantion of a date in the format <code>YYYYMMDD</code> <code>shard_id</code> <code>STRING</code> A <code>STRING</code> representantion of a table shard date in the format <code>YYYYMMDD</code> <code>shard_date</code> <code>DATE</code> A <code>DATE</code> representantion of a table shard date <code>partition_id</code> <code>STRING</code> A <code>STRING</code> representantion of a table partition date in the format <code>YYYYMMDD</code> <code>partition_date</code> <code>DATE</code> A <code>DATE</code> representantion of a table partition date"},{"location":"bigquery/functions/","title":"BigQuery Functions","text":"<p>The following GoogleSQL functions are deployed to transform and augment inbound data.  The original published article can be found on Medium here.</p>"},{"location":"bigquery/functions/#format_date","title":"FORMAT_DATE","text":"<p>The <code>FORMAT_DATE</code> function is used to convert a <code>DATE</code> value into a <code>STRING</code> with a specific date syntax. In this case the <code>'%Y%m%d'</code> date syntax formats the output into a string in the format <code>YYYYMMDD</code>.</p> <pre><code>SELECT FORMAT_DATE('%Y%m%d', '2024-01-07')\n</code></pre> <pre><code>&gt; 20240107\n</code></pre>"},{"location":"bigquery/functions/#parse_date","title":"PARSE_DATE","text":"<p>The <code>PARSE_DATE</code> function is the inverse of the <code>FORMAT_DATE</code> function, and is used to convert a <code>STRING</code> value into a <code>DATE</code> value, given an expected date syntax in the input STRING value.\u00a0</p> <pre><code>SELECT PARSE_DATE('%Y%m%d', '20240107')\n</code></pre> <pre><code>&gt; 2024-01-07\n</code></pre>"},{"location":"bigquery/functions/#_table_suffix","title":"_TABLE_SUFFIX","text":"<p>The <code>_TABLE_SUFFIX</code> is technically a pseudo-column (a metadata column which is hidden but can be queried), which can be used in conjunction with a wildcard query and the <code>FORMAT_DATE</code> function to efficiently query the <code>events_YYYYMMDD</code> table. Note that this query assumes that the <code>start_date</code> and <code>end_date</code> <code>DATE</code> variables have been set as script variables or table function arguments.</p> <pre><code>SELECT \n_TABLE_SUFFIX AS table_suffix, *\nFROM `[project_id].analytics_#########].events_*`\nWHERE _TABLE_SUFFIX BETWEEN \nFORMAT_DATE(\"%Y%m%d\", start_date) AND \nFORMAT_DATE(\"%Y%m%d\", end_date)\n</code></pre> <p>This query syntax returns all source table columns with the <code>_TABLE_SUFFIX</code> as a <code>STRING</code> column called <code>table_suffix</code> before the rest of the columns.</p>"},{"location":"bigquery/functions/#to_json_string","title":"TO_JSON_STRING","text":"<p>The <code>TO_JSON_STRING</code> function returns a JSON-formatted <code>STRING</code> representation of the data passed to it as an argument. This argument can be a variable, column value or the name of a preceding common table expression, as in the example below.</p> <pre><code>WITH\nadd_ids AS (\n  SELECT \n  'project_id' AS project_id,\n  'analytics_123456789' AS dataset_name)\n\nSELECT \nTO_JSON_STRING(add_ids) AS add_ids_json\nFROM add_ids\n</code></pre> <pre><code>&gt; {\"project_id\":\"project_id\",\"dataset_name\":\"analytics_123456789\"}\n</code></pre> <p><code>NULL</code> values are also preserved in the output, which makes it robust to unpredictable input data. This can be observed in the output from the example below.</p> <pre><code>WITH\nadd_ids AS (\n  SELECT \n  'project_id' AS project_id,\n  'analytics_123456789' AS dataset_name,\n  NULL AS example_value)\n\nSELECT \nTO_JSON_STRING(add_ids) AS add_ids_json\nFROM add_ids\n</code></pre> <pre><code>&gt; {\"project_id\":\"project_id\",\"dataset_name\":\"analytics_123456789\",\"example_value\":null}\n</code></pre> <p><code>ARRAY</code> and <code>STRUCT</code> values also directly map to <code>JSON</code>, so any BigQuery data structure can be represented in <code>JSON</code>.</p> <p>Note that the function <code>TO_JSON</code> can be used interchangeably with this function, in which case the function will return a <code>JSON</code> value instead of a JSON-formatted <code>STRING</code> value.\u00a0</p>"},{"location":"bigquery/functions/#sha256","title":"SHA256","text":"<p>The <code>SHA256</code> function is a hashing function, which returns a 44 character <code>BYTES</code> value based on an input <code>STRING</code> or <code>BYTES</code> of any length. For a given input it will always return the same output, which makes it a useful function to check for uniqueness or identicality of inputs. Adding this to the example above gives a unique id for each row of data in the <code>add_ids</code> common table expression.</p> <pre><code>WITH\nadd_ids AS (\n  SELECT \n  'project_id' AS project_id,\n  'analytics_123456789' AS dataset_name,\n  NULL AS example_value)\n\nSELECT \nSHA256(TO_JSON_STRING(add_ids)) AS row_id\nFROM add_ids\n</code></pre> <pre><code>&gt; XBbBYHTigXnQLJwZQ9dJ0y8TJexcWfhBiJWfp2pdVfE=\n</code></pre>"},{"location":"bigquery/functions/#to_hex","title":"TO_HEX","text":"<p>The TO_HEX function is a function which converts a sequence of <code>BYTES</code> (as returned by the <code>SHA256</code> function above) into a hexadecimal <code>STRING</code>. This means that the resulting <code>STRING</code> will only contain the characters <code>0..9</code> and <code>a..f</code>, making it cleaner for certain additional operations and copy/paste actions in the user interface.</p> <pre><code>WITH\nadd_ids AS (\n  SELECT \n  'project_id' AS project_id,\n  'analytics_123456789' AS dataset_name,\n  NULL AS example_value)\n\nSELECT \nTO_HEX(SHA256(TO_JSON_STRING(add_ids))) AS row_id\nFROM add_ids\n</code></pre> <pre><code>&gt; 5c16c16074e28179d02c9c1943d749d32f1325ec5c59f84188959fa76a5d55f1\n</code></pre>"},{"location":"bigquery/functions/#coalesce","title":"COALESCE","text":"<p>The COALESCE function returns the first non-null element from a sequence of values. Note that all elements in the sequence need to be coercible to a common supertype.</p> <pre><code>SELECT COALESCE (NULL,\"value_x\",\"value_y\", NULL) AS value\n</code></pre> <pre><code>&gt; value_x\n</code></pre>"},{"location":"bigquery/functions/#safe_cast","title":"SAFE_CAST","text":"<p>The SAFE_CAST function is the <code>SAFE</code> version of the CAST function, meaning that if the input value cannot be <code>CAST</code> to the target data type, it will return <code>NULL</code> value instead of an error. Note that for many other functions this behaviour can be enforced by using the SAFE. prefix.</p> <pre><code>SELECT SAFE_CAST(\"value_x\" AS INT64) AS value\n</code></pre> <pre><code>&gt; null\n</code></pre> <p>Conversely, if using the CAST function, the function will error.</p> <pre><code>SELECT CAST(\"value_x\" AS INT64) AS value\n</code></pre> <pre><code>&gt; Query error: Bad int64 value: value_x at [1:1]\n</code></pre>"},{"location":"bigquery/functions/#timestamp_micros","title":"TIMESTAMP_MICROS","text":"<p>The TIMESTAMP_MICROS function converts a 16-digit unix timestamp (microseconds) to a <code>TIMESTAMP</code>.</p> <pre><code>SELECT TIMESTAMP_MICROS(1711353064567254) \n</code></pre> <pre><code>&gt; 2024-03-25 07:51:04.567254 UTC\n</code></pre>"},{"location":"bigquery/functions/#date","title":"DATE","text":"<p>The DATE function extracts the <code>DATE</code> from a <code>TIMESTAMP</code>. Used in conjunction with the <code>TIMESTAMP_MICROS</code> function, it enables conversion from a unix timestamp to a <code>DATE</code>.</p> <pre><code>SELECT DATE(TIMESTAMP_MICROS(1711353064567254));\n</code></pre> <pre><code>&gt; 2024-03-25\n</code></pre>"},{"location":"bigquery/functions/#time","title":"TIME","text":"<p>The TIME function extracts the <code>TIME</code> (independent of the date) from a <code>TIMESTAMP</code>. Used in conjunction with the <code>TIMESTAMP_MICROS</code> function, it enables conversion from a unix timestamp to a <code>TIME</code>.</p> <pre><code>SELECT TIME(TIMESTAMP_MICROS(1711353064567254));\n</code></pre> <pre><code>&gt; 07:51:04.567254\n</code></pre>"},{"location":"bigquery/functions/#regexp_contains","title":"REGEXP_CONTAINS","text":"<p>The REGEXP_CONTAINS function returns a <code>BOOL</code>, evaluating to <code>TRUE</code> if the input <code>STRING</code> matches the input regular expression:</p> <pre><code>SELECT REGEXP_CONTAINS('somebody@email.com', r'@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+') AS email_is_valid\n</code></pre> <pre><code>&gt; true\n</code></pre> <p>If the <code>STRING</code> does not match the regular expression, it will evaluate to <code>FALSE</code>.</p> <pre><code>SELECT REGEXP_CONTAINS('not_an_email.com', r'@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+') AS email_is_valid\n</code></pre> <pre><code>&gt; false\n</code></pre> <p>One important characteristic to note is that if either function argument is <code>NULL</code>, the expression will evaluate to <code>NULL</code>.</p> <pre><code>SELECT REGEXP_CONTAINS(NULL , r'@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+') AS email_is_valid\n</code></pre> <pre><code>&gt; null\n</code></pre> <pre><code>SELECT REGEXP_CONTAINS('somebody@email.com', NULL) AS email_is_valid\n</code></pre> <pre><code>&gt; null\n</code></pre>"},{"location":"ga4/","title":"Google Analytics 4","text":""},{"location":"ga4/#motivation","title":"Motivation","text":"<p>The Google Analytics 4 export to BigQuery has a complex structure which is extremely difficult to query in SQL, making analytics tasks time-consuming and SQL code extremely long, difficult to understand and error-prone.</p>"},{"location":"ga4/#objective","title":"Objective","text":"<p>The Google Analytics 4 (GA4) decoder simplifies and augments the GA4 BigQuery export, making subsequent data operations simpler and quicker.</p> <p>It enables automatic pre-modelling of the GA4 BigQuery <code>events_YYYYMMDD</code> export, providing flattened, date-partitioned <code>events</code> and <code>sessions</code> tables containing all standard and observed <code>event_params</code> and <code>user_properties</code>.  It also provides mechanisms to detect new <code>event_params</code> and <code>user_properties</code> values and to incrementally update the schema based on inbound data detection.</p> <p>It can be installed using a one-line command in the BigQuery console by permitted users on registered datasets, and has no dependencies on any external platforms or API calls.</p>"},{"location":"ga4/#access","title":"Access","text":"<p>The Google Analytics 4 Decoder is in pre-launch with selected agencies and enterprises. Apply for access here.</p>"},{"location":"ga4/#quickstart","title":"Quickstart","text":"<p>Follow these instructions to get started as quickly as possible.</p>"},{"location":"ga4/#installation","title":"Installation","text":"<p>The GA4 decoder can be deployed in the same dataset as the inbound GA4 dataset (<code>ga4_dataset_id</code>), or a different dataset if desired.  Note that the installation function needs to be called in the same region in which the GA4 dataset is located (in the examples below, for the <code>us</code> multi-region).</p>"},{"location":"ga4/#basic-installation","title":"Basic Installation","text":"<p>In the following installation examples, the <code>event_options</code> <code>JSON</code> variable is <code>NULL</code>, which means that default installation options are used. The <code>event_options</code> is the mechanism via which custom installation configurations are set.</p> Basic installation in the GA4 datasetBasic installation in a different datasetConcise syntax <pre><code>  DECLARE ga4_dataset_id, decoder_dataset_id STRING;\n  DECLARE event_options JSON DEFAULT JSON '{}';\n\n  SET ga4_dataset_id = 'project_id.analytics_##########';\n  SET decoder_dataset_id = ga4_dataset_id;\n\n  CALL decodedata.us.install_ga4_decoder(ga4_dataset_id, decoder_dataset_id, event_options);\n</code></pre> <pre><code>  DECLARE ga4_dataset_id, decoder_dataset_id STRING;\n  DECLARE event_options JSON DEFAULT JSON '{}';\n\n  SET ga4_dataset_id = 'project_id.analytics_##########';\n  SET decoder_dataset_id = 'project_id.decoder_dataset_name';\n\n  CALL decodedata.us.install_ga4_decoder(ga4_dataset_id, decoder_dataset_id, event_options);\n</code></pre> <pre><code>CALL decodedata.us.install_ga4_decoder('project_id.analytics_##########', 'project_id.decoder_dataset_name' NULL);\n</code></pre>"},{"location":"ga4/#output-resources","title":"Output Resources","text":""},{"location":"ga4/#output-tables","title":"Output Tables","text":"<p>Following installation, these output tables are built in the <code>decoder_dataset_id</code> dataset:</p> Resource Name Resource Type Partitioning Column Row Granularity <code>events</code> <code>TABLE</code> <code>event_date</code> One row per event <code>sessions</code> <code>TABLE</code> <code>event_date</code> One row per session <p>Detailed information regarding the transformation, augmentation and schema is available in the events and sessions docs.</p> <p>These date-partitioned tables will be built from the latest data upon installation.</p>"},{"location":"ga4/#functions","title":"Functions","text":"<p>Following installation, these execution functions are also deployed in the <code>decoder_dataset_id</code> dataset:</p> Resource Name  Resource Type Arguments  Action <code>INSTALL_DECODER</code> <code>PROCEDURE</code> none Reinstall decoder with original deployment options <code>RUN_DECODER</code> <code>PROCEDURE</code> <code>execution_options JSON</code> Execute the decoder and refresh output tables <p>The <code>decoder_dataset_id.INSTALL_DECODER()</code> function is executed to reinstall the decoder with the original installation configuration.  It also rebuilds output tables with the full historic data.</p> <p>The <code>decoder_dataset_id.RUN_DECODER(execution_options)</code> function is executed to refresh output tables with the transformed latest arriving data.</p>"},{"location":"ga4/#automation","title":"Automation","text":"<p>The <code>RUN_DECODER</code> function has two different execution modes: <code>incremental</code> and <code>full</code>. Execution mode is set using the <code>execution_options</code> <code>JSON</code> arguments.</p> <p>In order to efficiently automate the decoder, a simple BigQuery scheduled query can be used to call the <code>RUN_DECODER</code> function periodically (typically every hour).  Since it is querying metadata to identify newly arriving date partitions, the underlying data is never queried, meaning that the compute required for the automation is predictable and low (see the Compute Estimate section).</p>"},{"location":"ga4/#incremental-refresh","title":"Incremental Refresh","text":"<p>The <code>incremental</code> execution mode is the optimal mode to keep the output tables up-to-date in a cost-efficient manner. It compares inbound and outbound table metadata to determine when new date partitions arrive, and runs on those partitions only (plus an additional <code>n</code> days, due to late arriving data in the GA4 export).  Note that since the source data can change up to 72 hours after the table is created, it is recommended to set this to 4 days.</p> Incremental refreshConcise syntax <pre><code>DECLARE execution_options JSON DEFAULT JSON '{\"mode\": \"incremental\", \"date_partitions_to_replace\": 4}';\n\nCALL `decoder_dataset_id.us.RUN_DECODER`(execution_options);\n</code></pre> <pre><code>CALL `decoder_dataset_id.us.RUN_DECODER`(JSON '{\"mode\": \"incremental\", \"date_partitions_to_replace\": 4}');\n</code></pre>"},{"location":"ga4/#full-refresh","title":"Full Refresh","text":"<p>To execute a full refresh of output tables between the first observed source shard data and the <code>CURRENT_DATE</code>, use the following <code>execution_options</code>:</p> Full refreshConcise syntax <pre><code>DECLARE execution_options JSON DEFAULT JSON '{\"mode\": \"full\"}';\n\nCALL `decoder_dataset_id.us.RUN_DECODER`(execution_options);\n</code></pre> <pre><code>CALL `decoder_dataset_id.us.RUN_DECODER`(JSON '{\"mode\": \"full\"}');\n</code></pre>"},{"location":"ga4/#default-mode","title":"Default mode","text":"<p>If the <code>execution_options</code> <code>JSON</code> argument is <code>NULL</code>, the execution defaults to <code>mode = incremental</code> and <code>date_partitions_to_replace = 4</code>.</p> Default incremental cxecutionConcise syntax <pre><code>DECLARE execution_options JSON DEFAULT NULL;\n\nCALL `decoder_dataset_id.us.RUN_DECODER`(execution_options);\n</code></pre> <pre><code>CALL `decoder_dataset_id.us.RUN_DECODER`(NULL);\n</code></pre>"},{"location":"ga4/#compute-estimate","title":"Compute Estimate","text":"<p>The compute automation component to run the GA4 decoder hourly is approximately $0.135 per property per month. This consumption will not increase over time, regardless of inbound data volumes.</p> Component Logic Value Unit Execution Processing 3 x 10MB Metadata Queries 30 MB Monthly Executions 30 days * 24hrs 720 Executions Monthly Compute 720 Executions * 30MB 21.6 GB Compute Unit Cost 1TB On-Demand Compute = $6.25 0.00625 $/GB Total AutomationMonthly Compute 21.6GB * $0.00625 0.135 $"},{"location":"ga4/access/","title":"Access","text":"Loading\u2026"},{"location":"ga4/advanced/","title":"Advanced","text":"<p>Additional advanced options are available to customise the custom model deployment, enabling explicit inclusion or exclusion of <code>event_name</code> values and <code>event_param</code>/<code>user_property</code> keys, in addition to other profiling options.</p> <p>There are a number of reasons why you might want to pre-filter the data stream.  This could be because of historical setup issues, to exclude values defined during a testing period, automated migration from an external tool or Google, or simply because the <code>event_names</code>, <code>event_params</code> or <code>user_properties</code> you use have evolved over time. </p> <p>We provide a mechanism to pre-filter the stream to implement a variety of logical scenarios.</p>"},{"location":"ga4/advanced/#event-options","title":"Event Options","text":"<p>Advanced filters are implemented via the <code>event_options JSON</code> variable, which is passed as a <code>NULL</code> <code>JSON</code> value to the <code>decodedata.region.install_ga4_decoder</code> function in the default installation. <code>JSON</code> paths are parsed from the <code>event_options</code> variable, the schema for which will comprise a subset of the following <code>JSON</code> keys:</p> <pre><code>{\n    \"start_date\": \"&lt;[DATE]&gt;\",\n    \"end_date\": \"&lt;[DATE]&gt;\",\n    \"stream_id_in\": [\"&lt;ARRAY&lt;STRING&gt;\"],\n    \"stream_id_not_in\": [\"&lt;ARRAY&lt;STRING&gt;\"],\n    \"event_name_like_any\": [\"&lt;ARRAY&lt;STRING&gt;\"],\n    \"event_name_not_like_any\": [\"&lt;ARRAY&lt;STRING&gt;\"],\n    \"event_param_like_any\": [\"&lt;ARRAY&lt;STRING&gt;\"],\n    \"event_param_not_like_any\": [\"&lt;ARRAY&lt;STRING&gt;\"],\n    \"user_property_like_any\": [\"&lt;ARRAY&lt;STRING&gt;\"],\n    \"user_property_not_like_any\" [\"&lt;ARRAY&lt;STRING&gt;\"]\n}\n</code></pre> <p>Note that the placeholders need to be replaced by a valid <code>JSON</code> value or array. Placeholder <code>\"&lt;[DATE]&gt;\"</code> would be replaced by e.g. <code>\"2024-01-01\"</code> and placeholder <code>[\"&lt;ARRAY&lt;STRING&gt;\"]</code> would be replaced by e.g. <code>[\"12345678\", \"87654321\"]</code>.</p>"},{"location":"ga4/advanced/#data-profile-filters","title":"Data Profile Filters","text":"<p>Note that in each logical case, events are not filtered out, simply excluded from the profiling and therefore not included in the relevant output <code>STRUCT</code> (<code>event_count</code>, <code>event_param</code>, <code>user_property</code>).  This means that the row count for the result of a query against the <code>[dataset_id].GA4_EVENTS</code> date-bounded table function for a specific date range should precisely match the row count in both the source GA4 table shard range <code>[dataset_id].events_*</code> and the output table <code>[dataset_id].EVENTS</code>.</p>"},{"location":"ga4/advanced/#date-range","title":"Date Range","text":"<p>Date ranges filter the specific date range used to build the custom decoder functions, only including columns in the decoded model which are observed in the defined date range (in addition to the standard set of columns). Neither or both <code>start_date</code> and <code>end_date</code> need to be passed in order for the deployment to be executed. </p> <p>advanced event_options: <code>start_date, end_date</code></p> JSONGoogleSQL (Static)GoogleSQL (Dynamic) <pre><code>{\n    \"start_date\": \"2023-01-01\",\n    \"end_date\": \"2023-12-31\"\n}\n</code></pre> <pre><code>DECLARE event_options JSON; \n\nSET event_options = JSON \"\"\"\n{\n    \"start_date\": \"2023-01-01\",\n    \"end_date\": \"2023-12-31\"\n};\n\"\"\";\n</code></pre> <pre><code>DECLARE event_options JSON; \n\nSET event_options = SELECT TO_JSON(( \nSELECT AS STRUCT\nCURRENT_DATE - 365 AS start_date,\nCURRENT_DATE AS end_date));\n</code></pre>"},{"location":"ga4/advanced/#stream-id","title":"Stream ID","text":"<p>Filtering on <code>stream_id</code> is typically only required if there have been setup irregularities, which are more commonly observed on Firebase data streams rather than GA4.</p>"},{"location":"ga4/advanced/#stream_id_in","title":"stream_id_in","text":"<p>This will only profile rows where the <code>stream_id</code> matches one defined in the <code>stream_id_in ARRAY&lt;STRING&gt;</code>:</p> <p>advanced event_options: <code>stream_id_in</code></p> JSONGoogleSQL <pre><code>{\n    \"stream_id_in\": [\"12345678\"]\n}\n</code></pre> <pre><code>DECLARE event_options JSON; \n\nSET event_options = JSON \"\"\"\n{\n    \"stream_id_in\": [\"12345678\"]\n};\n\"\"\"\n</code></pre>"},{"location":"ga4/advanced/#stream_id_not_in","title":"stream_id_not_in","text":"<p>This will only profile rows where the <code>stream_id</code> does not match any defined in the <code>stream_id_in ARRAY&lt;STRING&gt;</code>:</p> <p>advanced event_options: <code>stream_id_not_in</code></p> JSONGoogleSQL <pre><code>{\n    \"stream_id_not_in\": [\"87654321\", \"98765432\"]\n}\n</code></pre> <pre><code>DECLARE event_options JSON; \n\nSET event_options = JSON \"\"\"\n{\n    \"stream_id_not_in\": [\"87654321\", \"98765432\"]\n};\n\"\"\"\n</code></pre>"},{"location":"ga4/advanced/#event-names","title":"Event Names","text":""},{"location":"ga4/advanced/#event_name_like_any","title":"event_name_like_any","text":"<p>The <code>event_name</code> profile include filter is implemented using the <code>LIKE ANY</code> Quantified Like Operator. It will only include values in the <code>event_name</code> profile and decoder which match one of the values in the <code>event_name_like_any</code> <code>STRING ARRAY</code> (note that wildcards can be used to match specific patterns).</p> <p>Note that is is a more common pattern to filter out unwanted values from the profile by using the <code>event_name_not_like_any</code> filter option.</p>"},{"location":"ga4/advanced/#event_name_not_like_any","title":"event_name_not_like_any","text":"<p>The <code>event_name</code> profile exclude filter is implemented using the <code>NOT LIKE ANY</code> Quantified Like Operator. It will only include values in the <code>event_name</code> profile and decoder which do not match one of the values in the <code>event_name_not_like_any</code> <code>STRING ARRAY</code> (note that wildcards can be used to match specific patterns).</p> <p>advanced event_options: <code>event_name_not_like_any</code></p> JSONGoogleSQL <pre><code>{\n    \"event_name_like_any\": [\"test%\", \"http:%\"]\n}\n</code></pre> <pre><code>DECLARE event_options JSON; \n\nSET event_options = JSON \"\"\"\n{\n    \"event_name_like_any\": [\"test%\", \"http:%\"]\n};\n\"\"\"\n</code></pre>"},{"location":"ga4/advanced/#event-params","title":"Event Params","text":""},{"location":"ga4/advanced/#event_param_like_any","title":"event_param_like_any","text":"<p>The <code>event_param</code> profile include filter is implemented using the <code>LIKE ANY</code> Quantified Like Operator. It will only include values in the <code>event_param</code> profile and decoder which match one of the values in the <code>event_param_like_any</code> <code>STRING ARRAY</code> (note that wildcards can be used to match specific patterns).</p> <p>Note that is is a more common pattern to filter out unwanted values from the profile by using the <code>event_param_not_like_any</code> filter option.</p>"},{"location":"ga4/advanced/#event_param_not_like_any","title":"event_param_not_like_any","text":"<p>The <code>event_param</code> profile exclude filter is implemented using the <code>NOT LIKE ANY</code> Quantified Like Operator. It will only include values in the <code>event_param</code> profile and decoder which do not match one of the values in the <code>event_param_not_like_any</code> <code>STRING ARRAY</code> (note that wildcards can be used to match specific patterns).</p> <p>advanced event_options: <code>event_param_not_like_any</code></p> JSONGoogleSQL <pre><code>{\n    \"event_param_not_like_any\": [\"test%\", \"http:%\", \"%_test\"]\n}\n</code></pre> <pre><code>DECLARE event_options JSON; \n\nSET event_options = JSON \"\"\"\n{\n    \"event_param_not_like_any\": [\"test%\", \"http:%\", \"%_test\"]\n};\n\"\"\"\n</code></pre>"},{"location":"ga4/advanced/#user-properties","title":"User Properties","text":""},{"location":"ga4/advanced/#user_property_like_any","title":"user_property_like_any","text":"<p>The <code>user_property</code> profile include filter is implemented using the <code>LIKE ANY</code> Quantified Like Operator. It will only include values in the <code>user_property</code> profile and decoder which match one of the values in the <code>user_property_like_any</code> <code>STRING ARRAY</code> (note that wildcards can be used to match specific patterns).</p> <p>Note that is is a more common pattern to filter out unwanted values from the profile by using the <code>user_property_not_like_any</code> filter option.</p>"},{"location":"ga4/advanced/#user_property_not_like_any","title":"user_property_not_like_any","text":"<p>The <code>user_property</code> profile exclude filter is implemented using the <code>NOT LIKE ANY</code> Quantified Like Operator. It will only include values in the <code>user_property</code> profile and decoder which do not match one of the values in the <code>user_property_not_like_any</code> <code>STRING ARRAY</code> (note that wildcards can be used to match specific patterns).</p> <p>advanced event_options: <code>event_param_not_like_any</code></p> JSONGoogleSQL <pre><code>{\n    \"user_property_not_like_any\": [\"test%\", \"http:%\", \"%_test\"]\n}\n</code></pre> <pre><code>DECLARE event_options JSON; \n\nSET event_options = JSON \"\"\"\n{\n    \"user_property_not_like_any\": [\"test%\", \"http:%\", \"%_test\"]\n}    \n\"\"\"\n</code></pre>"},{"location":"ga4/quickstart/","title":"Quickstart","text":""},{"location":"ga4/quickstart/#access","title":"Access","text":"<p>The Google Analytics 4 Decoder is in pre-launch with selected agencies and enterprises. Apply for access here.</p>"},{"location":"ga4/quickstart/#installation","title":"Installation","text":"<p>To install and run the decoder in the GA4 dataset, with default options, execute the following code in your BigQuery console, replacing <code>project_id.analytics_##########</code> with your GA4 <code>dataset_id</code> and click the <code>Run</code> button.</p> Default installation <pre><code>  CALL decodedata.us.install_ga4_decoder('project_id.analytics_##########', 'project_id.analytics_##########', NULL);\n</code></pre> <p>Note that decoder functions will only add new functions, tables and views to your GA4 dataset, and never delete anything.</p>"},{"location":"ga4/quickstart/#execution","title":"Execution","text":"<p>Upon installation, to execute an incremental update on your data execute the following code in your BigQuery console, replacing <code>project_id.analytics_##########</code> with your GA4 <code>dataset_id</code>.  This will only write new date partitions to your outbound tables when new source data is detected:</p> Default execution <pre><code>  CALL `project_id.analytics_##########`.RUN_DECODER(NULL)\n</code></pre> <p>This is a metadata query, so you will not be charged for querying the underlying data.</p>"},{"location":"ga4/sessions/","title":"Events","text":""},{"location":"ga4/sessions/#overview","title":"Overview","text":"<p>The <code>sessions</code> table is a flattened date-partitioned session-level aggregation of the <code>events</code> table. The attibution model defaults to <code>last_click_non_direct</code>, but can also be configured as <code>last_click</code>, <code>first_click</code> or  <code>first_click_non_direct</code>.</p> <p>One row represents one single discrete session.</p>"},{"location":"ga4/sessions/#schema","title":"Schema","text":"Output <code>sessions</code> schema <pre><code>    events\n        \u251c\u2500\u2500 session_id STRING   \n        \u251c\u2500\u2500 project_id STRING   \n        \u251c\u2500\u2500 dataset_name STRING \n        \u251c\u2500\u2500 analytics_property_id STRING    \n        \u251c\u2500\u2500 stream_id STRING    \n        \u251c\u2500\u2500 platform STRING \n        \u251c\u2500\u2500 user_pseudo_id STRING   \n        \u251c\u2500\u2500 is_active_user BOOLEAN  \n        \u251c\u2500\u2500 is_engaged_session BOOLEAN  \n        \u251c\u2500\u2500 event_date DATE \n        \u251c\u2500\u2500 session_start_timestamp TIMESTAMP   \n        \u251c\u2500\u2500 session_end_timestamp TIMESTAMP \n        \u251c\u2500\u2500 event_names ARRAY&lt;STRING&gt;   \n        \u251c\u2500\u2500 privacy_info STRUCT \n        \u251c\u2500\u2500 user_first_touch_timestamp TIMESTAMP    \n        \u251c\u2500\u2500 user_ltv STRUCT \n        \u251c\u2500\u2500 device STRUCT   \n        \u251c\u2500\u2500 geo STRUCT  \n        \u251c\u2500\u2500 app_info STRUCT \n        \u251c\u2500\u2500 attribution_model STRING    \n        \u251c\u2500\u2500 traffic_source STRUCT   \n        \u251c\u2500\u2500 event_dimensions STRUCT \n        \u251c\u2500\u2500 collected_traffic_source STRUCT \n        \u251c\u2500\u2500 channel_grouping STRING \n        \u251c\u2500\u2500 local STRUCT    \n        \u251c\u2500\u2500 event_value_in_usd FLOAT    \n        \u251c\u2500\u2500 count STRUCT    \n        \u2514\u2500\u2500 parameter STRUCT    \n</code></pre>"},{"location":"ga4/sessions/#aggregation-columns","title":"Aggregation Columns","text":"<p>The following columns are used as aggregation dimensions, meaning that one row will correspond to a unique combination of these column values.</p> COLUMN NAME DATA TYPE DESCRIPTION session_id STRING Unique ID per session project_id STRING <code>project_id</code> containing the <code>ga4_dataset_id</code> dataset_name STRING <code>dataset_name</code> of the GA4 dataset analytics_property_id STRING <code>analytics_property_id</code> of the GA4 dataset event_id STRING Unique ID per event stream_id STRING ID of GA4 stream platform STRING Web or App user_pseudo_id STRING Unique ID corresponding to identified user"},{"location":"ga4/sessions/#aggregated-metadata-columns","title":"Aggregated Metadata Columns","text":"<p>The following columns are aggregated in order to make sense at a session-level aggregation.</p> COLUMN NAME DATA TYPE DEFINITION DESCRIPTION event_date DATE <code>MIN(event_date)</code> The <code>event_date</code> of the first occurring event in a session session_start_timestamp DATE <code>MIN(event_timestamp)</code> The <code>event_timestamp</code> of the first occurring event in a session session_end_timestamp TIMESTAMP <code>MAX(event_timestamp)</code> The <code>event_timestamp</code> of the last occurring event in a session event_names ARRAY <code>ARRAY_AGG(DISTINCT event_name IGNORE NULLS)</code> \u00a0An array of unique <code>event_name</code> values in a session"},{"location":"ga4/sessions/#channel-grouping-column","title":"Channel Grouping Column","text":"<p>The <code>channel_grouping</code> <code>STRING</code> column is added, in alignment with the Google Default channel group logic.  This enables the <code>last_click_non_direct</code> and <code>last_click_non_direct</code> attribution models.</p>"},{"location":"ga4/sessions/#aggregated-metric-columns","title":"Aggregated Metric Columns","text":"<p>All columns in the <code>count</code> metric <code>STRUCT</code> in the <code>events</code> table are summed across all events in a session, with the naming convention unchanged (e.g. <code>SUM(count.page_view) AS page_view</code>).  Additionally, the following fields are summed across all event metrics:</p> COLUMN NAME DATA TYPE DEFINITION DESCRIPTION event_value_in_usd FLOAT <code>SUM(event_value_in_usd)</code> Sum of <code>event_value_in_usd</code> across all events in a session count.total_sessions INTEGER <code>1 AS total_sessions</code> An integer flag to enable <code>total_sessions</code> to be used as an output metric count.total_engaged_sessions INTEGER <code>MAX(SAFE_CAST(parameter.session_engaged AS INT64))</code> An integer flag to indicate whether the session was classified as engaged count.total_events INTEGER <code>SUM(count.total_events)</code> The count of events in a session count.total_conversion_events INTEGER <code>SUM(count.total_conversions)</code> Total conversion events in a session count.total_conversion_sessions INTEGER <code>MAX(count.total_conversions)</code> Flag (<code>1</code>) if a session contains at least one conversion event <p>The standard schema for the <code>count</code> <code>STRUCT</code> in the sessions table is therefore:</p> <pre><code>    count STRUCT    \n        \u251c\u2500\u2500 sessions INTEGER    \n        \u251c\u2500\u2500 engaged_sessions INTEGER    \n        \u251c\u2500\u2500 events INTEGER  \n        \u251c\u2500\u2500 conversion_events INTEGER   \n        \u251c\u2500\u2500 conversion_sessions INTEGER \n        \u251c\u2500\u2500 click INTEGER   \n        \u251c\u2500\u2500 file_download INTEGER   \n        \u251c\u2500\u2500 first_visit INTEGER \n        \u251c\u2500\u2500 form_start INTEGER  \n        \u251c\u2500\u2500 form_submit INTEGER \n        \u251c\u2500\u2500 page_view INTEGER   \n        \u251c\u2500\u2500 purchase INTEGER    \n        \u251c\u2500\u2500 scroll INTEGER  \n        \u251c\u2500\u2500 search INTEGER  \n        \u251c\u2500\u2500 session_start INTEGER   \n        \u251c\u2500\u2500 user_engagement INTEGER \n        \u251c\u2500\u2500 video_complete INTEGER  \n        \u251c\u2500\u2500 video_progress INTEGER  \n        \u251c\u2500\u2500 video_start INTEGER \n        \u2514\u2500\u2500 view_search_results INTEGER \n</code></pre>"},{"location":"ga4/sessions/#attributed-columns","title":"Attributed Columns","text":"<p>The following column values are selected based on the attribution model configured upon deployment(<code>first_click</code>, <code>last_click</code>, <code>first_click_non_direct</code> and <code>last_click_non_direct</code>), with direct-attributed events defined by the <code>channel_grouping</code>.  The attribution model for the deployment is then recorded in the <code>attribution_model</code> <code>STRING</code> column.</p> COLUMN NAME DATA TYPE privacy_info STRUCT user_first_touch_timestamp TIMESTAMP user_ltv STRUCT device STRUCT geo STRUCT app_info STRUCT traffic_source STRUCT event_dimensions STRUCT collected_traffic_source STRUCT channel_grouping STRING local STRUCT"},{"location":"ga4/sessions/#parameterproperty-columns","title":"Parameter/Property Columns","text":"<p>Additionally, for <code>parameter</code> and <code>property</code> values observed at the <code>event</code> level, the <code>MAX</code> of the column value is taken, ensuring that if any value is <code>NOT NULL</code>, the <code>MAX</code> value will be propagated to the <code>sessions.parameter</code> or <code>sessions.property</code> <code>STRUCT</code>.  The naming convention is unchanged from the <code>event</code> table. </p> <p>If specific <code>parameter</code> or <code>property</code> sub-columns require different aggregation treatment (e.g. <code>SUM</code>), this is configurable upon deployment. By default the only parameter sub-column which is summed is <code>parameter.total_engagement_time_msec</code>, which is defined as <code>SUM(parameter.engagement_time_msec)</code> across all session events.</p> <p>The standard schema for the <code>parameter</code> <code>STRUCT</code> in the sessions table is therefore:</p> <pre><code>parameter STRUCT    \n    \u251c\u2500\u2500 total_engagement_time_msec INTEGER  \n    \u251c\u2500\u2500 anonymize_ip STRING \n    \u251c\u2500\u2500 batch_ordering_id INTEGER   \n    \u251c\u2500\u2500 batch_page_id INTEGER   \n    \u251c\u2500\u2500 campaign STRING \n    \u251c\u2500\u2500 debug_mode INTEGER  \n    \u251c\u2500\u2500 engaged_session_event INTEGER   \n    \u251c\u2500\u2500 engagement_time_msec INTEGER    \n    \u251c\u2500\u2500 entrances INTEGER   \n    \u251c\u2500\u2500 file_extension STRING   \n    \u251c\u2500\u2500 file_name STRING    \n    \u251c\u2500\u2500 form_destination STRING \n    \u251c\u2500\u2500 form_id STRING  \n    \u251c\u2500\u2500 form_name STRING    \n    \u251c\u2500\u2500 ga_session_id INTEGER   \n    \u251c\u2500\u2500 ga_session_number INTEGER   \n    \u251c\u2500\u2500 ignore_referrer STRING  \n    \u251c\u2500\u2500 link_classes STRING \n    \u251c\u2500\u2500 link_domain STRING  \n    \u251c\u2500\u2500 link_id STRING  \n    \u251c\u2500\u2500 link_text STRING    \n    \u251c\u2500\u2500 link_url STRING \n    \u251c\u2500\u2500 medium STRING   \n    \u251c\u2500\u2500 outbound STRING \n    \u251c\u2500\u2500 page_location STRING    \n    \u251c\u2500\u2500 page_path STRING    \n    \u251c\u2500\u2500 page_referrer STRING    \n    \u251c\u2500\u2500 page_title STRING   \n    \u251c\u2500\u2500 percent_scrolled INTEGER    \n    \u251c\u2500\u2500 search_term STRING  \n    \u251c\u2500\u2500 session_engaged STRING  \n    \u251c\u2500\u2500 source STRING   \n    \u251c\u2500\u2500 term STRING \n    \u251c\u2500\u2500 video_current_time INTEGER  \n    \u251c\u2500\u2500 video_duration INTEGER  \n    \u251c\u2500\u2500 video_percent STRING    \n    \u251c\u2500\u2500 video_provider STRING   \n    \u251c\u2500\u2500 video_title STRING  \n    \u251c\u2500\u2500 video_url STRING    \n    \u2514\u2500\u2500 visible STRING  \n</code></pre>"},{"location":"ga4/signup/","title":"","text":""},{"location":"ga4/events/","title":"Events","text":""},{"location":"ga4/events/#overview","title":"Overview","text":"<p>The <code>events</code> table is a flattened transformation of the raw inbound <code>events_YYYYMMDD</code> table, with the following structural and semantic changes:</p> <ul> <li>Simplified flat output structure for optimal query syntax</li> <li>Simple event count metrics for comparison and calculations</li> <li>Standard and custom event parameters in property-specific flat schema</li> <li>Custom user properties in property-specific flat schema</li> <li>Geo-based local timestamps for time-of-day analyses</li> <li>Observation-based data type coalescence to prevent type-based historic data loss</li> <li>Session and event ids to support robust data quality assurance processes</li> </ul> <p>One row represents one single discrete event.</p>"},{"location":"ga4/events/#schema","title":"Schema","text":"Original <code>events_YYYYMMDD</code> schemaOutput <code>events</code> schema <pre><code>events_YYYYMMDD\n    \u251c\u2500\u2500 event_date STRING   \n    \u251c\u2500\u2500 event_timestamp INTEGER \n    \u251c\u2500\u2500 event_name STRING   \n    \u251c\u2500\u2500 event_params ARRAY&lt;STRUCT&gt;  \n    \u251c\u2500\u2500 event_previous_timestamp INTEGER    \n    \u251c\u2500\u2500 event_value_in_usd FLOAT    \n    \u251c\u2500\u2500 event_bundle_sequence_id INTEGER    \n    \u251c\u2500\u2500 event_server_timestamp_offset INTEGER   \n    \u251c\u2500\u2500 user_id STRING  \n    \u251c\u2500\u2500 user_pseudo_id STRING   \n    \u251c\u2500\u2500 privacy_info STRUCT \n    \u251c\u2500\u2500 user_properties ARRAY&lt;STRUCT&gt;   \n    \u251c\u2500\u2500 user_first_touch_timestamp INTEGER  \n    \u251c\u2500\u2500 user_ltv STRUCT \n    \u251c\u2500\u2500 device STRUCT   \n    \u251c\u2500\u2500 geo STRUCT  \n    \u251c\u2500\u2500 app_info STRUCT \n    \u251c\u2500\u2500 traffic_source STRUCT   \n    \u251c\u2500\u2500 stream_id STRING    \n    \u251c\u2500\u2500 platform STRING \n    \u251c\u2500\u2500 event_dimensions STRUCT \n    \u251c\u2500\u2500 ecommerce STRUCT    \n    \u251c\u2500\u2500 items ARRAY&lt;STRUCT&gt; \n    \u251c\u2500\u2500 collected_traffic_source STRUCT \n    \u2514\u2500\u2500 is_active_user BOOLEAN  \n</code></pre> <pre><code>events\n    \u251c\u2500\u2500 project_id STRING   \n    \u251c\u2500\u2500 dataset_name STRING \n    \u251c\u2500\u2500 analytics_property_id STRING    \n    \u251c\u2500\u2500 event_id STRING \n    \u251c\u2500\u2500 session_id STRING   \n    \u251c\u2500\u2500 event_date DATE \n    \u251c\u2500\u2500 event_timestamp TIMESTAMP   \n    \u251c\u2500\u2500 event_name STRING   \n    \u251c\u2500\u2500 event_previous_timestamp TIMESTAMP  \n    \u251c\u2500\u2500 event_value_in_usd FLOAT    \n    \u251c\u2500\u2500 event_bundle_sequence_id INTEGER    \n    \u251c\u2500\u2500 event_server_timestamp_offset TIMESTAMP \n    \u251c\u2500\u2500 user_id STRING  \n    \u251c\u2500\u2500 user_pseudo_id STRING   \n    \u251c\u2500\u2500 privacy_info STRUCT \n    \u251c\u2500\u2500 user_first_touch_timestamp TIMESTAMP    \n    \u251c\u2500\u2500 user_ltv STRUCT \n    \u251c\u2500\u2500 device STRUCT   \n    \u251c\u2500\u2500 geo STRUCT  \n    \u251c\u2500\u2500 app_info STRUCT \n    \u251c\u2500\u2500 traffic_source STRUCT   \n    \u251c\u2500\u2500 stream_id STRING    \n    \u251c\u2500\u2500 platform STRING \n    \u251c\u2500\u2500 event_dimensions STRUCT \n    \u251c\u2500\u2500 collected_traffic_source STRUCT \n    \u251c\u2500\u2500 is_active_user BOOLEAN\n    \u251c\u2500\u2500 local STRUCT    \n    \u251c\u2500\u2500 count STRUCT\n    \u251c\u2500\u2500 parameter STRUCT\n    \u2514\u2500\u2500 property STRUCT     \n</code></pre>"},{"location":"ga4/events/#new-columns-metadata","title":"New Columns (Metadata)","text":"<p>The following metadata columns are added to the output <code>events</code> table.</p> COLUMN NAME DATA TYPE DESCRIPTION project_id STRING <code>project_id</code> containing the <code>ga4_dataset_id</code> dataset_name STRING <code>dataset_name</code> of the GA4 dataset analytics_property_id STRING <code>analytics_property_id</code> of the GA4 dataset event_id STRING Unique ID per event session_id STRING Unique ID per session"},{"location":"ga4/events/#existing-columns","title":"Existing Columns","text":"<p>The following columns are passed through directly from the raw <code>events_YYYYMMDD</code>, with no changes to structure or data type:</p> COLUMN NAME DATA TYPE event_name STRING event_value_in_usd FLOAT event_bundle_sequence_id INTEGER event_server_timestamp_offset INTEGER user_id STRING user_pseudo_id STRING privacy_info STRUCT user_ltv STRUCT device STRUCT geo STRUCT app_info STRUCT traffic_source STRUCT stream_id STRING platform STRING event_dimensions STRUCT collected_traffic_source STRUCT is_active_user BOOLEAN privacy_info STRUCT user_ltv STRUCT device STRUCT geo STRUCT app_info STRUCT traffic_source STRUCT event_dimensions STRUCT collected_traffic_source STRUCT"},{"location":"ga4/events/#data-type-changes","title":"Data Type Changes","text":"<p>The following columns are included in the <code>events</code> output table, with appropriate data type changes.</p> COLUMN NAME FROM DATA TYPE TO DATA TYPE DESCRIPTION event_date STRING DATE Inbound shard date event_timestamp INTEGER TIMESTAMP UTC timestamp of event occurrence event_previous_timestamp INTEGER TIMESTAMP UTC timestamp of previous event occurrence user_first_touch_timestamp INTEGER TIMESTAMP UTC timestamp of user first touch"},{"location":"ga4/events/#new-columns-augmented","title":"New Columns (Augmented)","text":"<p>The following augmentation columns are added to the output <code>events</code> table:</p> <pre><code>local STRUCT    \n    \u251c\u2500\u2500 timezone_id STRING  \n    \u251c\u2500\u2500 timezone_name STRING    \n    \u251c\u2500\u2500 country_code STRING \n    \u251c\u2500\u2500 timezone_source STRING  \n    \u251c\u2500\u2500 latitude STRING \n    \u251c\u2500\u2500 longitude STRING    \n    \u251c\u2500\u2500 date DATE   \n    \u251c\u2500\u2500 timestamp DATETIME  \n    \u251c\u2500\u2500 time TIME   \n    \u251c\u2500\u2500 hour INTEGER    \n    \u251c\u2500\u2500 hour_decimal FLOAT  \n    \u251c\u2500\u2500 previous_timestamp DATETIME \n    \u2514\u2500\u2500 first_touch_timestamp DATETIME  \n</code></pre> COLUMN NAME DATA TYPE DESCRIPTION local STRUCT NEW local timezone and geolocation STRUCT local.timezone_id STRING NEW timezone id local.timezone_name STRING NEW timezone name local.country_code STRING NEW ISO country code local.timezone_source STRING NEW source of timezone allocation (city/region/country) local.latitude STRING NEW latitude local.longitude STRING NEW longitude local.date DATE NEW geo-adjusted <code>event_date</code> local.timestamp DATETIME NEW geo-adjusted <code>event_timestamp</code> local.time TIME NEW geo-adjusted time local.hour INTEGER NEW geo-adjusted hour local.hour_decimal FLOAT NEW geo-adjusted decimal hour local.previous_timestamp DATETIME NEW geo-adjusted <code>previous_timestamp</code> local.first_touch_timestamp DATETIME NEW geo-adjusted <code>first_touch_timestamp</code>"},{"location":"ga4/events/#new-columns-restructured","title":"New Columns (Restructured)","text":"<p>The following flat <code>STRUCT</code> columns are added, replacing the nested source columns which are excluded from the output <code>events</code> table. The <code>event_name</code> column is still included in the output <code>events</code> table, but is supplemented with the <code>count</code> metrics <code>STRUCT</code>.</p> SOURCE COLUMN NAME SOURCE DATA TYPE TRANSFORMATION event_name STRING Transformed to <code>count</code> metric STRUCT event_params ARRAY Transformed to <code>parameter</code> STRUCT user_properties ARRAY Transformed to <code>property</code> STRUCT"},{"location":"ga4/events/#count-schema","title":"Count Schema","text":"<p>The following metric sub-columns are included as standard in the <code>count</code> <code>STRUCT</code>, in addition to any other <code>event_name</code> values detected in the data.</p> <pre><code>count STRUCT    \n    \u251c\u2500\u2500 events INTEGER  \n    \u251c\u2500\u2500 conversions INTEGER \n    \u251c\u2500\u2500 click INTEGER   \n    \u251c\u2500\u2500 file_download INTEGER   \n    \u251c\u2500\u2500 first_visit INTEGER \n    \u251c\u2500\u2500 form_start INTEGER  \n    \u251c\u2500\u2500 form_submit INTEGER \n    \u251c\u2500\u2500 page_view INTEGER   \n    \u251c\u2500\u2500 purchase INTEGER    \n    \u251c\u2500\u2500 scroll INTEGER  \n    \u251c\u2500\u2500 search INTEGER  \n    \u251c\u2500\u2500 session_start INTEGER   \n    \u251c\u2500\u2500 user_engagement INTEGER \n    \u251c\u2500\u2500 video_complete INTEGER  \n    \u251c\u2500\u2500 video_progress INTEGER  \n    \u251c\u2500\u2500 video_start INTEGER \n    \u2514\u2500\u2500 view_search_results INTEGER \n</code></pre>"},{"location":"ga4/events/#parameter-schema","title":"Parameter Schema","text":"<p>The following value sub-columns are included as standard in the <code>parameter</code> <code>STRUCT</code>, in addition to any other <code>event_parameter</code> values detected in the data. <pre><code>    parameter STRUCT    \n        \u251c\u2500\u2500 anonymize_ip STRING \n        \u251c\u2500\u2500 batch_ordering_id INTEGER   \n        \u251c\u2500\u2500 batch_page_id INTEGER   \n        \u251c\u2500\u2500 campaign STRING \n        \u251c\u2500\u2500 debug_mode INTEGER  \n        \u251c\u2500\u2500 engaged_session_event INTEGER   \n        \u251c\u2500\u2500 engagement_time_msec INTEGER    \n        \u251c\u2500\u2500 entrances INTEGER   \n        \u251c\u2500\u2500 file_extension STRING   \n        \u251c\u2500\u2500 file_name STRING    \n        \u251c\u2500\u2500 form_destination STRING \n        \u251c\u2500\u2500 form_id STRING  \n        \u251c\u2500\u2500 form_name STRING    \n        \u251c\u2500\u2500 ga_session_id INTEGER   \n        \u251c\u2500\u2500 ga_session_number INTEGER   \n        \u251c\u2500\u2500 ignore_referrer STRING  \n        \u251c\u2500\u2500 link_classes STRING \n        \u251c\u2500\u2500 link_domain STRING  \n        \u251c\u2500\u2500 link_id STRING  \n        \u251c\u2500\u2500 link_text STRING    \n        \u251c\u2500\u2500 link_url STRING \n        \u251c\u2500\u2500 medium STRING   \n        \u251c\u2500\u2500 outbound STRING \n        \u251c\u2500\u2500 page_location STRING    \n        \u251c\u2500\u2500 page_path STRING    \n        \u251c\u2500\u2500 page_referrer STRING    \n        \u251c\u2500\u2500 page_title STRING   \n        \u251c\u2500\u2500 percent_scrolled INTEGER    \n        \u251c\u2500\u2500 search_term STRING  \n        \u251c\u2500\u2500 session_engaged STRING  \n        \u251c\u2500\u2500 source STRING   \n        \u251c\u2500\u2500 term STRING \n        \u251c\u2500\u2500 video_current_time INTEGER  \n        \u251c\u2500\u2500 video_duration INTEGER  \n        \u251c\u2500\u2500 video_percent STRING    \n        \u251c\u2500\u2500 video_provider STRING   \n        \u251c\u2500\u2500 video_title STRING  \n        \u251c\u2500\u2500 video_url STRING    \n        \u2514\u2500\u2500 visible STRING  \n</code></pre></p>"},{"location":"ga4/events/#property-schema","title":"Property Schema","text":"<p>There are no standard values for <code>user_properties</code>, so sub-columns will only be included in the property <code>STRUCT</code> if they are detected in the data.</p>"},{"location":"ga4/events/event_names/","title":"Event Names","text":""},{"location":"ga4/events/event_names/#overview","title":"Overview","text":"<p>Events all have a non-null <code>event_name</code>, which is retained in the decoder output <code>event_name</code> column. These are also included as <code>INT64</code> sub-columns of the <code>count</code> <code>STRUCT</code>, enabling them to be used as metrics (and therefore based inputs for additional computations) in the decoder output tables.</p>"},{"location":"ga4/events/event_names/#standard-event-names","title":"Standard Event Names","text":"<p>The following event names are included as standard in the GA4 decoder output tables, whether they are observed in the source data or not. </p> EVENT NAME click file_download first_visit form_start form_submit page_view purchase scroll search session_start user_engagement video_complete video_progress video_start view_search_results"},{"location":"ga4/events/event_names/#custom-event-names","title":"Custom Event Names","text":"<p>When additional event names are detected in the source data, they will be preserved in the <code>event_name</code> column and will also be included in the <code>count</code> output <code>STRUCT</code>. These will be found after the alphabetically listed standard event names, so they can be easily identified.  Recommended event parameters are included if they are in the expected or observed custom event parameters.</p>"},{"location":"ga4/events/event_names/#new-event-metrics","title":"New Event Metrics","text":"<p>The following sub-columns are added to the <code>count</code> metric STRUCT to enable simple subsequent computations:</p> COLUMN NAME DATA TYPE DESCRIPTION count.total_events INTEGER An integer flag to enable <code>total_events</code> to be used as an output metric count.total_conversions INTEGER An integer flag to enable <code>total_conversions</code> to be used as an output metric <p>Note that <code>event_name</code> values to be classified as conversions are set in the installation configuration, but defaults to <code>purchase</code> as per the Google default.  These can be renamed in subsequent transformations or BI tools to retain consistency with whatever confusing Google name changes happen in future. </p>"},{"location":"ga4/events/event_names/#output-schema","title":"Output Schema","text":"<p>The schema of the output <code>count</code> <code>STRUCT</code> is therefore:</p> <pre><code>count STRUCT\n\u251c\u2500\u2500 total_events INT64\n\u251c\u2500\u2500 total_conversions INT64\n\u251c\u2500\u2500 click INT64\n\u251c\u2500\u2500 file_download INT64\n\u251c\u2500\u2500 first_visit INT64\n\u251c\u2500\u2500 form_start INT64\n\u251c\u2500\u2500 form_submit INT64\n\u251c\u2500\u2500 page_view INT64\n\u251c\u2500\u2500 purchase INT64\n\u251c\u2500\u2500 scroll INT64\n\u251c\u2500\u2500 search INT64\n\u251c\u2500\u2500 session_start INT64\n\u251c\u2500\u2500 user_engagement INT64\n\u251c\u2500\u2500 video_complete INT64\n\u251c\u2500\u2500 video_progress INT64\n\u251c\u2500\u2500 video_start INT64\n\u251c\u2500\u2500 view_search_results INT64\n\u2514\u2500\u2500 [custom event NAMES]\n</code></pre>"},{"location":"ga4/events/event_parameters/","title":"Event Parameters","text":""},{"location":"ga4/events/event_parameters/#overview","title":"Overview","text":"<p>Event parameters are found in the <code>event_params</code> <code>STRUCT</code>, an unusually structured element which is the source of most of the complexity when working with the GA4 export in BigQuery.  It is a nested variation on a key-value pair, where the value can be found in one (and only one) of the value sub-columns.  The <code>STRUCT</code> schema can be represented as follows:</p> <pre><code>event_params STRUCT\n\u251c\u2500\u2500 key STRING\n\u2514\u2500\u2500 value\n    \u251c\u2500\u2500 string_value STRING\n    \u251c\u2500\u2500 int_value INT64\n    \u251c\u2500\u2500 float_value FLOAT64\n    \u2514\u2500\u2500 double_value FLOAT64\n</code></pre> <p>This structure means that new parameters can be added without changing the table schema, but it also means that data types can change over time, with no simple built-in mechanism for detection.</p>"},{"location":"ga4/events/event_parameters/#standard-event-parameters","title":"Standard Event Parameters","text":"<p>The following event parameters are included as standard in the GA4 decoder output tables, whether they are observed in the source data or not.</p> COLUMN NAME DATA TYPE anonymize_ip STRING batch_ordering_id INT64 batch_page_id INT64 campaign STRING debug_mode INT64 engaged_session_event INT64 engagement_time_msec INT64 entrances INT64 file_extension STRING file_name STRING form_destination STRING form_id STRING form_name STRING ga_session_id INT64 ga_session_number INT64 ignore_referrer STRING link_classes STRING link_domain STRING link_id STRING link_text STRING link_url STRING medium STRING outbound STRING page_location STRING page_path STRING page_referrer STRING page_title STRING percent_scrolled INT64 search_term STRING session_engaged STRING source STRING term STRING video_current_time INT64 video_duration INT64 video_percent STRING video_provider STRING video_title STRING video_url STRING visible STRING <p>The default name for the event parameter output <code>STRUCT</code> is <code>parameter</code>, but this is configurable upon installation.  </p> <p>These event parameter values can then be accessed concisely by using dot notation, for example: <code>parameter.video_title</code>.</p>"},{"location":"ga4/events/event_parameters/#inconsistent-data-types","title":"Inconsistent Data Types","text":""},{"location":"ga4/events/event_parameters/#session_engaged","title":"<code>session_engaged</code>","text":"<p>The <code>session_engaged</code> column values have been observed to be either <code>STRING</code> or <code>INT64</code> values, which is automatically corrected for in the GA4 decoder. This can be seen in the <code>GA4_event_params</code> decoder function, for which the generated code is below.</p> <pre><code>(SELECT COALESCE(SAFE_CAST(value.int_value AS STRING), value.string_value) FROM UNNEST(event_params) WHERE key='session_engaged') AS `session_engaged`\n</code></pre> <p>Note that many articles and guides wrongly extract the <code>session_engaged</code> value as either an <code>INT64</code> or <code>STRING</code> column, which we have observed to under-report engaged sessions by 3-12%.</p>"},{"location":"ga4/events/event_parameters/#automatic-type-coalescence","title":"Automatic Type Coalescence","text":"<p>When multiple data types are observed for an event parameter in the source data, if only one of the value sub-columns is used then data will be lost. </p> <p>The GA4 decoder controls for this by combining <code>COALESCE</code> and <code>SAFE_CAST</code> as above, with the output data type dependent on which combination of non-null values are observed. They will be coalesced to a common supertype. For example, if <code>STRING</code> and <code>INT64</code> values are observed, they resulting field will be a <code>STRING</code>, and if <code>INT64</code> AND <code>FLOAT64</code> values are observed, the resulting field will be a <code>FLOAT64</code>.</p>"},{"location":"ga4/events/event_parameters/#custom-event-parameters","title":"Custom Event Parameters","text":"<p>When additional parameters are detected in the source data, they will also be included in the <code>parameter</code> output <code>STRUCT</code>. These will be found after the standard alphabetically listed event parameters, so they can be easily identified.  Recommended event parameters are included if they are in the expected or observed custom event parameters.</p>"},{"location":"ga4/events/event_parameters/#output-schema","title":"Output Schema","text":"<p>The schema of the output <code>parameter</code> <code>STRUCT</code> is therefore:</p> <pre><code>event_params STRUCT\n\u251c\u2500\u2500 anonymize_ip STRING\n\u251c\u2500\u2500 batch_ordering_id INT64\n\u251c\u2500\u2500 batch_page_id INT64\n\u251c\u2500\u2500 campaign STRING\n\u251c\u2500\u2500 debug_mode INT64\n\u251c\u2500\u2500 engaged_session_event INT64\n\u251c\u2500\u2500 engagement_time_msec INT64\n\u251c\u2500\u2500 entrances INT64\n\u251c\u2500\u2500 file_extension STRING\n\u251c\u2500\u2500 file_name STRING\n\u251c\u2500\u2500 form_destination STRING\n\u251c\u2500\u2500 form_id STRING\n\u251c\u2500\u2500 form_name STRING\n\u251c\u2500\u2500 ga_session_id INT64\n\u251c\u2500\u2500 ga_session_number INT64\n\u251c\u2500\u2500 ignore_referrer STRING\n\u251c\u2500\u2500 link_classes STRING\n\u251c\u2500\u2500 link_domain STRING\n\u251c\u2500\u2500 link_id STRING\n\u251c\u2500\u2500 link_text STRING\n\u251c\u2500\u2500 link_url STRING\n\u251c\u2500\u2500 medium STRING\n\u251c\u2500\u2500 outbound STRING\n\u251c\u2500\u2500 page_location STRING\n\u251c\u2500\u2500 page_path STRING\n\u251c\u2500\u2500 page_referrer STRING\n\u251c\u2500\u2500 page_title STRING\n\u251c\u2500\u2500 percent_scrolled INT64\n\u251c\u2500\u2500 search_term STRING\n\u251c\u2500\u2500 session_engaged STRING\n\u251c\u2500\u2500 source STRING\n\u251c\u2500\u2500 term STRING\n\u251c\u2500\u2500 video_current_time INT64\n\u251c\u2500\u2500 video_duration INT64\n\u251c\u2500\u2500 video_percent STRING\n\u251c\u2500\u2500 video_provider STRING\n\u251c\u2500\u2500 video_title STRING\n\u251c\u2500\u2500 video_url STRING\n\u251c\u2500\u2500 visible STRING\n\u2514\u2500\u2500 [custom event parameters]\n</code></pre>"}]}